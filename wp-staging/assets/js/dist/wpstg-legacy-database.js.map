{"version":3,"file":"wpstg-legacy-database.js","sources":["../src/wpstg-legacy-database.js"],"sourcesContent":["(function($) {\n  window.addEventListener('database-backups-tab', function() {\n    WPStagingLegacyDatabase.init();\n  });\n\n  const WPStagingLegacyDatabase = {\n    type: null,\n    isCancelled: false,\n    processInfo: {\n      title: null,\n      interval: null,\n    },\n    cache: {\n      elements: [],\n      get: function(selector) {\n      // It is already cached!\n        if ($.inArray(selector, this.elements) !== -1) {\n          return this.elements[selector];\n        }\n\n        // Create cache and return\n        this.elements[selector] = $(selector);\n\n        return this.elements[selector];\n      },\n      refresh: function(selector) {\n        selector.elements[selector] = $(selector);\n      },\n    },\n    init() {\n      WPStagingLegacyDatabase.fetchListing();\n      this.create();\n      this.delete();\n      this.restore();\n      this.edit();\n\n      // noinspection JSIgnoredPromiseFromCall\n\n\n      $('body')\n          .off('change', '#wpstg--backups--filter')\n          .on('change', '#wpstg--backups--filter', function() {\n            const $records = $('#wpstg-existing-database-backups').find('> div[id][data-type].wpstg-backup');\n            if (this.value === '') {\n              $records.show();\n            } else if (this.value === 'database') {\n              $records.filter('[data-type=\"site\"]').hide();\n              $records.filter('[data-type=\"database\"]').show();\n            } else if (this.value === 'site') {\n              $records.filter('[data-type=\"database\"]').hide();\n              $records.filter('[data-type=\"site\"]').show();\n            }\n          })\n          .on('click', '.wpstg--backup--download', function() {\n            const url = this.getAttribute('data-url');\n            if (url.length > 0) {\n              window.location.href = url;\n              return;\n            }\n            WPStagingLegacyDatabase.downloadModal({\n              titleExport: this.getAttribute('data-title-export'),\n              title: this.getAttribute('data-title'),\n              id: this.getAttribute('data-id'),\n              btnTxtCancel: this.getAttribute('data-btn-cancel-txt'),\n              btnTxtConfirm: this.getAttribute('data-btn-download-txt'),\n            });\n          })\n          .off('click', '#wpstg-import-backup')\n          .on('click', '#wpstg-import-backup', function() {\n            WPStagingLegacyDatabase.importModal();\n          })\n      // Import\n          .off('click', '.wpstg--backup--import--choose-option')\n          .on('click', '.wpstg--backup--import--choose-option', function() {\n            const $parent = $(this).parent();\n            if (!$parent.hasClass('wpstg--show-options')) {\n              $parent.addClass('wpstg--show-options');\n              $(this).text($(this).attr('data-txtChoose'));\n            } else {\n              $parent.removeClass('wpstg--show-options');\n              $(this).text($(this).attr('data-txtOther'));\n            }\n          })\n          .off('click', '.wpstg--modal--backup--import--search-replace--new')\n          .on('click', '.wpstg--modal--backup--import--search-replace--new', function(e) {\n            e.preventDefault();\n            const $container = $(Swal.getContainer()).find('.wpstg--modal--backup--import--search-replace--input--container');\n            const total = $container.find('.wpstg--modal--backup--import--search-replace--input-group').length;\n            $container.append(WPStagingLegacyDatabase.modal.import.searchReplaceForm.replace(/{i}/g, total));\n          })\n          .off('input', '.wpstg--backup--import--search')\n          .on('input', '.wpstg--backup--import--search', function() {\n            const index = parseInt(this.getAttribute('data-index'));\n            if (!isNaN(index)) {\n              WPStagingLegacyDatabase.modal.import.data.search[index] = this.value;\n            }\n          })\n          .off('input', '.wpstg--backup--import--replace')\n          .on('input', '.wpstg--backup--import--replace', function() {\n            const index = parseInt(this.getAttribute('data-index'));\n            if (!isNaN(index)) {\n              WPStagingLegacyDatabase.modal.import.data.replace[index] = this.value;\n            }\n          })\n      // Other Options\n          .off('click', '.wpstg--backup--import--option[data-option]')\n          .on('click', '.wpstg--backup--import--option[data-option]', function() {\n            const option = this.getAttribute('data-option');\n\n            if (option === 'file') {\n              $('input[type=\"file\"][name=\"wpstg--backup--import--upload--file\"]').click();\n              return;\n            }\n\n            if (option === 'upload') {\n              WPStagingLegacyDatabase.modal.import.containerFilesystem.hide();\n              WPStagingLegacyDatabase.modal.import.containerUpload.show();\n              $('.wpstg--backup--import--choose-option').click();\n              $('.wpstg--modal--backup--import--search-replace--wrapper').show();\n            }\n\n            if (option !== 'filesystem') {\n              return;\n            }\n\n            WPStagingLegacyDatabase.modal.import.containerUpload.hide();\n            const $containerFilesystem = WPStagingLegacyDatabase.modal.import.containerFilesystem;\n            $containerFilesystem.show();\n\n            fetch(`${ajaxurl}?action=wpstg--backups--import--file-list&_=${Math.random()}&accessToken=${wpstg.accessToken}&nonce=${wpstg.nonce}`)\n                .then(WPStagingLegacyDatabase.handleFetchErrors)\n                .then((res) => res.json())\n                .then((res) => {\n                  const $ul = $('.wpstg--modal--backup--import--filesystem ul');\n                  $ul.empty();\n\n                  if (!res || WPStagingLegacyDatabase.isEmpty(res)) {\n                    $ul.append(`<span id=\"wpstg--backups--import--file-list-empty\">No import file found! Upload an import file to the folder above.</span><br />`);\n                    $('.wpstg--modal--backup--import--search-replace--wrapper').hide();\n                    return;\n                  }\n\n                  $ul.append(`<span id=\"wpstg--backups--import--file-list\">Select file to import:</span><br />`);\n                  res.forEach(function(file, index) {\n                  // var checked = (index === 0) ? 'checked' : '';\n                    $ul.append(`<li><label><input name=\"backup_import_file\" type=\"radio\" value=\"${file.fullPath}\">${file.name} <br /> ${file.size}</label></li>`);\n                  });\n                  // $('.wpstg--modal--actions .swal2-confirm').prop('disabled', false);\n                  return res;\n                })\n                .catch((e) => WPStagingLegacyDatabase.showAjaxFatalError(e, '', 'Submit an error report.'))\n            ;\n          })\n          .off('change', 'input[type=\"file\"][name=\"wpstg--backup--import--upload--file\"]')\n          .on('change', 'input[type=\"file\"][name=\"wpstg--backup--import--upload--file\"]', function() {\n            WPStagingLegacyDatabase.modal.import.setFile(this.files[0] || null);\n            $('.wpstg--backup--import--choose-option').click();\n          })\n          .off('change', 'input[type=\"radio\"][name=\"backup_import_file\"]')\n          .on('change', 'input[type=\"radio\"][name=\"backup_import_file\"]', function() {\n            $('.wpstg--modal--actions .swal2-confirm').prop('disabled', false);\n            WPStagingLegacyDatabase.modal.import.data.file = this.value;\n          })\n      // Drag & Drop\n          .on('drag dragstart dragend dragover dragenter dragleave drop', '.wpstg--modal--backup--import--upload--container', function(e) {\n            e.preventDefault();\n            e.stopPropagation();\n          })\n          .on('dragover dragenter', '.wpstg--modal--backup--import--upload--container', function() {\n            $(this).addClass('wpstg--has-dragover');\n          })\n          .on('dragleave dragend drop', '.wpstg--modal--backup--import--upload--container', function() {\n            $(this).removeClass('wpstg--has-dragover');\n          })\n          .on('drop', '.wpstg--modal--backup--import--upload--container', function(e) {\n            WPStagingLegacyDatabase.modal.import.setFile(e.originalEvent.dataTransfer.files[0] || null);\n          })\n      ;\n    },\n    create() {\n      var createBackup = function(data) {\n        WPStagingLegacyDatabase.resetErrors();\n\n        if (WPStagingLegacyDatabase.isCancelled) {\n        // Swal.close();\n          return;\n        }\n\n        const reset = data['reset'];\n        delete data['reset'];\n        let requestData = Object.assign({}, data);\n        let useResponseTitle = true;\n\n        if (data.type === 'database') {\n          WPStagingLegacyDatabase.type = data.type;\n\n          // Only send to back-end what BE is expecting to receive.\n          // Prevent error: Trying to hydrate DTO with value that does not exist.\n          delete requestData['includedDirectories'];\n          delete requestData['wpContentDir'];\n          delete requestData['availableDirectories'];\n          delete requestData['wpStagingDir'];\n          delete requestData['exportDatabase'];\n          delete requestData['includeOtherFilesInWpContent'];\n\n          requestData = WPStagingLegacyDatabase.requestData(\n              'tasks.backup.database.create',\n              {...requestData, type: 'manual'},\n          );\n        } else if (data.type === 'site') {\n          WPStagingLegacyDatabase.type = data.type;\n\n          // Only send to back-end what BE is expecting to receive.\n          // Prevent error: Trying to hydrate DTO with value that does not exist.\n          delete requestData['type'];\n\n          requestData = WPStagingLegacyDatabase.requestData(\n              'jobs.backup.site.create',\n              requestData,\n          );\n          useResponseTitle = false;\n          requestData.jobs.backup.site.create.directories = [\n            data.wpContentDir,\n          ];\n          requestData.jobs.backup.site.create.excludedDirectories = data.availableDirectories\n              .split('|')\n              .filter((item) => !data.includedDirectories.includes(item))\n              .map((item) => item)\n          ;\n          requestData.jobs.backup.site.create.includeOtherFilesInWpContent = [\n            data.includeOtherFilesInWpContent,\n          ];\n\n          // Do not exclude the wp-content/uploads/wp-staging using regex by default\n          // This folder is excluded by PHP without REGEX.\n          // requestData.jobs.backup.site.create.excludedDirectories.push(`#${data.wpStagingDir}*#`);\n\n          // delete requestData.jobs.backup.site.create.includedDirectories;\n          delete requestData.jobs.backup.site.create.wpContentDir;\n          delete requestData.jobs.backup.site.create.wpStagingDir;\n          delete requestData.jobs.backup.site.create.availableDirectories;\n        } else {\n          WPStagingLegacyDatabase.type = null;\n          Swal.close();\n          WPStagingLegacyDatabase.showError('Invalid Backup Type');\n          return;\n        }\n\n        WPStagingLegacyDatabase.timer.start();\n\n        const statusStop = () => {\n          console.log('Status: Stop');\n          clearInterval(WPStagingLegacyDatabase.processInfo.interval);\n          WPStagingLegacyDatabase.processInfo.interval = null;\n        };\n        const status = () => {\n          if (WPStagingLegacyDatabase.processInfo.interval !== null) {\n            return;\n          }\n          console.log('Status: Start');\n          WPStagingLegacyDatabase.processInfo.interval = setInterval(() => {\n            if (true === WPStagingLegacyDatabase.isCancelled) {\n              statusStop();\n              return;\n            }\n\n            if (WPStagingLegacyDatabase.status.hasResponse === false) {\n              return;\n            }\n\n            WPStagingLegacyDatabase.status.hasResponse = false;\n            fetch(`${ajaxurl}?action=wpstg--backups--status&accessToken=${wpstg.accessToken}&nonce=${wpstg.nonce}`)\n                .then((res) => res.json())\n                .then((res) => {\n                  WPStagingLegacyDatabase.status.hasResponse = true;\n                  if (typeof res === 'undefined') {\n                    statusStop();\n                  }\n\n                  if (WPStagingLegacyDatabase.processInfo.title === res.currentStatusTitle) {\n                    return;\n                  }\n\n                  WPStagingLegacyDatabase.processInfo.title = res.currentStatusTitle;\n                  const $container = $(Swal.getContainer());\n                  $container.find('.wpstg--modal--process--title').text(res.currentStatusTitle);\n                  $container.find('.wpstg--modal--process--percent').text('0');\n                })\n                .catch((e) => {\n                  WPStagingLegacyDatabase.status.hasResponse = true;\n                  WPStagingLegacyDatabase.showAjaxFatalError(e, '', 'Submit an error report.');\n                })\n            ;\n          }, 5000);\n        };\n\n        WPStaging.ajax(\n            {\n              action: 'wpstg--backups--database-legacy-create',\n              accessToken: wpstg.accessToken,\n              nonce: wpstg.nonce,\n              reset,\n              wpstg: requestData,\n            },\n            function(response) {\n              if (typeof response === 'undefined') {\n                setTimeout(function() {\n                  createBackup(data);\n                }, wpstg.delayReq);\n                return;\n              }\n\n              WPStagingLegacyDatabase.processResponse(response, useResponseTitle);\n              if (!useResponseTitle && !WPStagingLegacyDatabase.processInfo.interval) {\n                status();\n              }\n\n              if (response.status === false) {\n                createBackup(data);\n              } else if (response.status === true) {\n                $('#wpstg--progress--status').text('Backup successfully created!');\n                WPStagingLegacyDatabase.type = null;\n                if (WPStagingLegacyDatabase.messages.shouldWarn()) {\n                  // noinspection JSIgnoredPromiseFromCall\n                  WPStagingLegacyDatabase.fetchListing();\n                  WPStagingLegacyDatabase.logsModal();\n                  return;\n                }\n                statusStop();\n                Swal.close();\n                WPStagingLegacyDatabase.fetchListing()\n                    .then(() => {\n                      if (!response.backupId) {\n                        WPStagingLegacyDatabase.showError('Failed to get backup ID from response');\n                        return;\n                      }\n\n                      // TODO RPoC\n                      const $el = $(`.wpstg--backup--download[data-id=\"${response.backupId}\"]`);\n                      WPStagingLegacyDatabase.downloadModal({\n                        id: $el.data('id'),\n                        url: $el.data('url'),\n                        title: $el.data('title'),\n                        titleExport: $el.data('title-export'),\n                        btnTxtCancel: $el.data('btn-cancel-txt'),\n                        btnTxtConfirm: $el.data('btn-download-txt'),\n                      });\n                      $('.wpstg--modal--download--logs--wrapper').show();\n                      const $logsContainer = $('.wpstg--modal--process--logs');\n                      WPStagingLegacyDatabase.messages.data.all.forEach((message) => {\n                        const msgClass = `wpstg--modal--process--msg--${message.type.toLowerCase()}`;\n                        $logsContainer\n                            .append(`<p class=\"${msgClass}\">[${message.type}] - [${message.date}] - ${message.message}</p>`)\n                        ;\n                      });\n                    })\n                ;\n              } else {\n                setTimeout(function() {\n                  createBackup(data);\n                }, wpstg.delayReq);\n              }\n            },\n            'json',\n            false,\n            0, // Don't retry upon failure\n            1.25,\n        );\n      };\n\n      const $body = $('body');\n\n      $body\n          .off('click', 'input[name=\"backup_type\"]')\n          .on('click', 'input[name=\"backup_type\"]', function() {\n            const advancedOptions = $('.wpstg-advanced-options');\n            if (this.value === 'database') {\n              advancedOptions.hide();\n              return;\n            }\n            advancedOptions.show();\n          })\n          .off('click', '.wpstg--tab--toggle')\n          .on('click', '.wpstg--tab--toggle', function() {\n            const $target = $($(this).attr('data-target'));\n            $target.toggle();\n            if ($target.is(':visible')) {\n              $(this).find('span').text('▼');\n            } else {\n              $(this).find('span').text('►');\n            }\n          })\n          .off('change', '[name=\"includedDirectories\\[\\]\"], [type=\"checkbox\"][name=\"export_database\"]')\n          .on('change', '[type=\"checkbox\"][name=\"includedDirectories\\[\\]\"], [type=\"checkbox\"][name=\"export_database\"]', function() {\n            const totalDirs = $('[type=\"checkbox\"][name=\"includedDirectories\\[\\]\"]:checked').length;\n            const isExportDatabase = $('[type=\"checkbox\"][name=\"export_database\"]:checked').length === 1;\n            if (totalDirs < 1 && !isExportDatabase) {\n              $('.swal2-confirm').prop('disabled', true);\n            } else {\n              $('.swal2-confirm').prop('disabled', false);\n            }\n          })\n      ;\n\n      // Add backup name and notes\n      $('#wpstg--tab--database-backups')\n          .off('click', '#wpstg-new-database-backup')\n          .on('click', '#wpstg-new-database-backup', async function(e) {\n            WPStagingLegacyDatabase.resetErrors();\n            e.preventDefault();\n            WPStagingLegacyDatabase.isCancelled = false;\n\n            if (!WPStagingLegacyDatabase.modal.create.html || !WPStagingLegacyDatabase.modal.create.confirmBtnTxt) {\n              const $newBackupModal = $('#wpstg--modal--database--new');\n              const html = $newBackupModal.html();\n              const btnTxt = $newBackupModal.attr('data-confirmButtonText');\n              WPStagingLegacyDatabase.modal.create.html = html || null;\n              WPStagingLegacyDatabase.modal.create.confirmBtnTxt = btnTxt || null;\n              $newBackupModal.remove();\n            }\n\n            const {value: formValues} = await Swal.fire({\n              title: '',\n              html: WPStagingLegacyDatabase.modal.create.html,\n              focusConfirm: false,\n              confirmButtonText: WPStagingLegacyDatabase.modal.create.confirmBtnTxt,\n              showCancelButton: true,\n              preConfirm: () => {\n                const container = Swal.getContainer();\n\n                return {\n                  type: 'database',\n                  name: container.querySelector('input[name=\"backup_name\"]').value || null,\n                  notes: container.querySelector('textarea[name=\"backup_note\"]').value || null,\n                  includedDirectories: Array.from((container.querySelectorAll('input[name=\"includedDirectories\\\\[\\\\]\"]:checked') || [])).map((i) => i.value),\n                  wpContentDir: container.querySelector('input[name=\"wpContentDir\"]').value || null,\n                  availableDirectories: container.querySelector('input[name=\"availableDirectories\"]').value || null,\n                  wpStagingDir: container.querySelector('input[name=\"wpStagingDir\"]').value || null,\n                  exportDatabase: container.querySelector('input[name=\"export_database\"]:checked') !== null,\n                  includeOtherFilesInWpContent: container.querySelector('input[name=\"includeOtherFilesInWpContent\"]:checked') !== null,\n                };\n              },\n            });\n\n            if (!formValues) {\n              return;\n            }\n\n            formValues.reset = true;\n\n            WPStagingLegacyDatabase.process({\n              execute: () => {\n                WPStagingLegacyDatabase.messages.reset();\n                createBackup(formValues);\n              },\n            });\n          })\n      ;\n    },\n    isEmpty: function(obj) {\n      for (const prop in obj) {\n        if (obj.hasOwnProperty(prop)) {\n          return false;\n        }\n      }\n\n      return true;\n    },\n    isLoading: function(isLoading) {\n      if (!isLoading || isLoading === false) {\n        WPStagingLegacyDatabase.cache.get('.wpstg-loader').hide();\n      } else {\n        WPStagingLegacyDatabase.cache.get('.wpstg-loader').show();\n      }\n    },\n    showAjaxFatalError: function(response, prependMessage, appendMessage) {\n      prependMessage = prependMessage ? prependMessage + '<br/><br/>' : 'Something went wrong! <br/><br/>';\n      appendMessage = appendMessage ? appendMessage + '<br/><br/>' : '<br/><br/>Please try the <a href=\\'https://wp-staging.com/docs/wp-staging-settings-for-small-servers/\\' target=\\'_blank\\'>WP Staging Small Server Settings</a> or submit an error report and contact us.';\n\n      if (response === false) {\n        WPStagingLegacyDatabase.showError(prependMessage + ' Error: No response.' + appendMessage);\n        window.removeEventListener('beforeunload', WPStaging.warnIfClosingDuringProcess);\n        return;\n      }\n\n      if (typeof response.error !== 'undefined' && response.error) {\n        console.error(response.message);\n        WPStagingLegacyDatabase.showError(prependMessage + ' Error: ' + response.message + appendMessage);\n        window.removeEventListener('beforeunload', WPStaging.warnIfClosingDuringProcess);\n        return;\n      }\n    },\n    handleFetchErrors: function(response) {\n      if (!response.ok) {\n        WPStagingLegacyDatabase.showError('Error: ' + response.status + ' - ' + response.statusText + '. Please try again or contact support.');\n      }\n      return response;\n    },\n    showError: function(message) {\n      WPStagingLegacyDatabase.cache.get('#wpstg-try-again').css('display', 'inline-block');\n      WPStagingLegacyDatabase.cache.get('#wpstg-cancel-cloning').text('Reset');\n      WPStagingLegacyDatabase.cache.get('#wpstg-resume-cloning').show();\n      WPStagingLegacyDatabase.cache.get('#wpstg-error-wrapper').show();\n      WPStagingLegacyDatabase.cache.get('#wpstg-error-details').show().html(message);\n      WPStagingLegacyDatabase.cache.get('#wpstg-removing-clone').removeClass('loading');\n      WPStagingLegacyDatabase.cache.get('.wpstg-loader').hide();\n      $('.wpstg--modal--process--generic-problem').show().html(message);\n    },\n    resetErrors: function() {\n      WPStagingLegacyDatabase.cache.get('#wpstg-error-details').hide().html('');\n    },\n    /**\n   * Ajax Requests\n   * @param {Object} data\n   * @param {Function} callback\n   * @param {string} dataType\n   * @param {bool} showErrors\n   * @param {int} tryCount\n   * @param {float} incrementRatio\n   */\n    ajax: function(data, callback, dataType, showErrors, tryCount, incrementRatio = null) {\n      if ('undefined' === typeof (dataType)) {\n        dataType = 'json';\n      }\n\n      if (false !== showErrors) {\n        showErrors = true;\n      }\n\n      tryCount = 'undefined' === typeof (tryCount) ? 0 : tryCount;\n\n      const retryLimit = 10;\n\n      let retryTimeout = 10000 * tryCount;\n\n      incrementRatio = parseInt(incrementRatio);\n      if (!isNaN(incrementRatio)) {\n        retryTimeout *= incrementRatio;\n      }\n\n      $.ajax({\n        url: ajaxurl + '?action=wpstg_processing&_=' + (Date.now() / 1000),\n        type: 'POST',\n        dataType: dataType,\n        cache: false,\n        data: data,\n        error: function(xhr, textStatus, errorThrown) {\n          console.log(xhr.status + ' ' + xhr.statusText + '---' + textStatus);\n\n          // try again after 10 seconds\n          tryCount++;\n          if (tryCount <= retryLimit) {\n            setTimeout(function() {\n              WPStagingLegacyDatabase.ajax(data, callback, dataType, showErrors, tryCount, incrementRatio);\n              return;\n            }, retryTimeout);\n          } else {\n            const errorCode = 'undefined' === typeof (xhr.status) ? 'Unknown' : xhr.status;\n            WPStagingLegacyDatabase.showError(\n                'Fatal Error:  ' + errorCode + ' Please try the <a href=\\'https://wp-staging.com/docs/wp-staging-settings-for-small-servers/\\' target=\\'_blank\\'>WP Staging Small Server Settings</a> or submit an error report and contact us.',\n            );\n          }\n        },\n        success: function(data) {\n          if ('function' === typeof (callback)) {\n            callback(data);\n          }\n        },\n        statusCode: {\n          404: function() {\n            if (tryCount >= retryLimit) {\n              WPStagingLegacyDatabase.showError('Error 404 - Can\\'t find ajax request URL! Please try the <a href=\\'https://wp-staging.com/docs/wp-staging-settings-for-small-servers/\\' target=\\'_blank\\'>WP Staging Small Server Settings</a> or submit an error report and contact us.');\n            }\n          },\n          500: function() {\n            if (tryCount >= retryLimit) {\n              WPStagingLegacyDatabase.showError('Fatal Error 500 - Internal server error while processing the request! Please try the <a href=\\'https://wp-staging.com/docs/wp-staging-settings-for-small-servers/\\' target=\\'_blank\\'>WP Staging Small Server Settings</a> or submit an error report and contact us.');\n            }\n          },\n          504: function() {\n            if (tryCount > retryLimit) {\n              WPStagingLegacyDatabase.showError('Error 504 - It looks like your server is rate limiting ajax requests. Please try to resume after a minute. If this still not works try the <a href=\\'https://wp-staging.com/docs/wp-staging-settings-for-small-servers/\\' target=\\'_blank\\'>WP Staging Small Server Settings</a> or submit an error report and contact us.\\n\\ ');\n            }\n          },\n          502: function() {\n            if (tryCount >= retryLimit) {\n              WPStagingLegacyDatabase.showError('Error 502 - It looks like your server is rate limiting ajax requests. Please try to resume after a minute. If this still not works try the <a href=\\'https://wp-staging.com/docs/wp-staging-settings-for-small-servers/\\' target=\\'_blank\\'>WP Staging Small Server Settings</a> or submit an error report and contact us.\\n\\ ');\n            }\n          },\n          503: function() {\n            if (tryCount >= retryLimit) {\n              WPStagingLegacyDatabase.showError('Error 503 - It looks like your server is rate limiting ajax requests. Please try to resume after a minute. If this still not works try the <a href=\\'https://wp-staging.com/docs/wp-staging-settings-for-small-servers/\\' target=\\'_blank\\'>WP Staging Small Server Settings</a> or submit an error report and contact us.\\n\\ ');\n            }\n          },\n          429: function() {\n            if (tryCount >= retryLimit) {\n              WPStagingLegacyDatabase.showError('Error 429 - It looks like your server is rate limiting ajax requests. Please try to resume after a minute. If this still not works try the <a href=\\'https://wp-staging.com/docs/wp-staging-settings-for-small-servers/\\' target=\\'_blank\\'>WP Staging Small Server Settings</a> or submit an error report and contact us.\\n\\ ');\n            }\n          },\n          403: function() {\n            if (tryCount >= retryLimit) {\n              WPStagingLegacyDatabase.showError('Refresh page or login again! The process should be finished successfully. \\n\\ ');\n            }\n          },\n        },\n      });\n    },\n    modal: {\n      create: {\n        html: null,\n        confirmBtnTxt: null,\n      },\n      process: {\n        html: null,\n        cancelBtnTxt: null,\n        modal: null,\n      },\n      download: {\n        html: null,\n      },\n      import: {\n        html: null,\n        btnTxtNext: null,\n        btnTxtConfirm: null,\n        btnTxtCancel: null,\n        searchReplaceForm: null,\n        file: null,\n        containerUpload: null,\n        containerFilesystem: null,\n        setFile: (file, upload = true) => {\n          const toUnit = (bytes) => {\n            const i = Math.floor(Math.log(bytes) / Math.log(1024));\n            return (bytes / Math.pow(1024, i)).toFixed(2) * 1 + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\n          };\n\n          if (!file) {\n            return;\n          }\n\n          WPStagingLegacyDatabase.modal.import.file = file;\n          WPStagingLegacyDatabase.modal.import.data.file = file.name;\n          console.log(`File ${file.name}`);\n          $('.wpstg--backup--import--selected-file').html(`${file.name} <br /> (${toUnit(file.size)})`).show();\n          $('.wpstg--drag').hide();\n          $('.wpstg--drag-or-upload').show();\n\n          if (upload) {\n            $('.wpstg--modal--actions .swal2-confirm').prop('disabled', true);\n            WPStagingLegacyDatabase.upload.start();\n          }\n        },\n        baseDirectory: null,\n        data: {\n          file: null,\n          search: [],\n          replace: [],\n        },\n      },\n    },\n    messages: {\n      WARNING: 'warning',\n      ERROR: 'error',\n      INFO: 'info',\n      DEBUG: 'debug',\n      CRITICAL: 'critical',\n      data: {\n        all: [], // TODO RPoC\n        info: [],\n        error: [],\n        critical: [],\n        warning: [],\n        debug: [],\n      },\n      shouldWarn() {\n        return WPStagingLegacyDatabase.messages.data.error.length > 0 ||\n        WPStagingLegacyDatabase.messages.data.critical.length > 0\n        ;\n      },\n      countByType(type = WPStagingLegacyDatabase.messages.ERROR) {\n        return WPStagingLegacyDatabase.messages.data[type].length;\n      },\n      addMessage(message) {\n        if (Array.isArray(message)) {\n          message.forEach((item) => {\n            WPStagingLegacyDatabase.messages.addMessage(item);\n          });\n          return;\n        }\n        const type = message.type.toLowerCase() || 'info';\n        if (!WPStagingLegacyDatabase.messages.data[type]) {\n          WPStagingLegacyDatabase.messages.data[type] = [];\n        }\n        WPStagingLegacyDatabase.messages.data.all.push(message); // TODO RPoC\n        WPStagingLegacyDatabase.messages.data[type].push(message);\n      },\n      reset() {\n        WPStagingLegacyDatabase.messages.data = {\n          all: [],\n          info: [],\n          error: [],\n          critical: [],\n          warning: [],\n          debug: [],\n        };\n      },\n    },\n    timer: {\n      totalSeconds: 0,\n      interval: null,\n      start() {\n        if (null !== WPStagingLegacyDatabase.timer.interval) {\n          return;\n        }\n\n        const prettify = (seconds) => {\n          console.log(`Process running for ${seconds} seconds`);\n          // If potentially anything can exceed 24h execution time than that;\n          // const _seconds = parseInt(seconds, 10)\n          // const hours = Math.floor(_seconds / 3600)\n          // const minutes = Math.floor(_seconds / 60) % 60\n          // seconds = _seconds % 60\n          //\n          // return [hours, minutes, seconds]\n          //   .map(v => v < 10 ? '0' + v : v)\n          //   .filter((v,i) => v !== '00' || i > 0)\n          //   .join(':')\n          // ;\n          // Are we sure we won't create anything that exceeds 24h execution time? If not then this;\n          return `${(new Date(seconds * 1000)).toISOString().substr(11, 8)}`;\n        };\n\n        WPStagingLegacyDatabase.timer.interval = setInterval(() => {\n          $('.wpstg--modal--process--elapsed-time').text(prettify(WPStagingLegacyDatabase.timer.totalSeconds));\n          WPStagingLegacyDatabase.timer.totalSeconds++;\n        }, 1000);\n      },\n      stop() {\n        WPStagingLegacyDatabase.timer.totalSeconds = 0;\n        if (WPStagingLegacyDatabase.timer.interval) {\n          clearInterval(WPStagingLegacyDatabase.timer.interval);\n          WPStagingLegacyDatabase.timer.interval = null;\n        }\n      },\n    },\n    upload: {\n      reader: null,\n      file: null,\n      iop: 1000 * 1024,\n      uploadInfo(isShow) {\n        const $containerUpload = $('.wpstg--modal--import--upload--process');\n        const $containerUploader = $('.wpstg--uploader');\n        if (isShow) {\n          $containerUpload.css('display', 'flex');\n          $containerUploader.hide();\n          return;\n        }\n\n        $containerUploader.css('display', 'flex');\n        $containerUpload.hide();\n      },\n      start() {\n        console.log(`file ${WPStagingLegacyDatabase.modal.import.data.file}`);\n        WPStagingLegacyDatabase.upload.reader = new FileReader();\n        WPStagingLegacyDatabase.upload.file = WPStagingLegacyDatabase.modal.import.file;\n        WPStagingLegacyDatabase.upload.uploadInfo(true);\n        WPStagingLegacyDatabase.upload.sendChunk();\n      },\n      sendChunk(startsAt = 0) {\n        if (!WPStagingLegacyDatabase.upload.file) {\n          return;\n        }\n        const isReset = startsAt < 1;\n        const endsAt = startsAt + WPStagingLegacyDatabase.upload.iop + 1;\n        const blob = WPStagingLegacyDatabase.upload.file.slice(startsAt, endsAt);\n        WPStagingLegacyDatabase.upload.reader.onloadend = function(event) {\n          if (event.target.readyState !== FileReader.DONE) {\n            return;\n          }\n\n          const body = new FormData();\n          body.append('accessToken', wpstg.accessToken);\n          body.append('nonce', wpstg.nonce);\n          body.append('data', event.target.result);\n          body.append('filename', WPStagingLegacyDatabase.upload.file.name);\n          body.append('reset', isReset ? '1' : '0');\n\n\n          fetch(`${ajaxurl}?action=wpstg--backups--import--file-upload`, {\n            method: 'POST',\n            body,\n          }).then(WPStagingLegacyDatabase.handleFetchErrors)\n              .then((res) => res.json())\n              .then((res) => {\n                WPStagingLegacyDatabase.showAjaxFatalError(res, '', 'Submit an error report.');\n                const writtenBytes = startsAt + WPStagingLegacyDatabase.upload.iop;\n                const percent = Math.floor((writtenBytes / WPStagingLegacyDatabase.upload.file.size) * 100);\n                if (endsAt >= WPStagingLegacyDatabase.upload.file.size) {\n                  WPStagingLegacyDatabase.upload.uploadInfo(false);\n                  WPStagingLegacyDatabase.isLoading(false);\n                  $('.wpstg--modal--actions .swal2-confirm').prop('disabled', false);\n                  return;\n                }\n                $('.wpstg--modal--import--upload--progress--title > span').text(percent);\n                $('.wpstg--modal--import--upload--progress').css('width', `${percent}%`);\n                WPStagingLegacyDatabase.upload.sendChunk(endsAt);\n              })\n              .catch((e) => WPStagingLegacyDatabase.showAjaxFatalError(e, '', 'Submit an error report.'))\n          ;\n        };\n        WPStagingLegacyDatabase.upload.reader.readAsDataURL(blob);\n      },\n    },\n    status: {\n      hasResponse: null,\n      reTryAfter: 5000,\n    },\n    fetchListing(isResetErrors = true) {\n      WPStagingLegacyDatabase.isLoading(true);\n\n      if (isResetErrors) {\n        WPStagingLegacyDatabase.resetErrors();\n      }\n\n      return fetch(`${ajaxurl}?action=wpstg--backups--database-legacy-listing&_=${Math.random()}&accessToken=${wpstg.accessToken}&nonce=${wpstg.nonce}`)\n          .then(WPStagingLegacyDatabase.handleFetchErrors)\n          .then((res) => res.json())\n          .then((res) => {\n            WPStagingLegacyDatabase.showAjaxFatalError(res, '', 'Submit an error report.');\n            WPStagingLegacyDatabase.cache.get('#wpstg--tab--database-backups').html(res);\n            WPStagingLegacyDatabase.isLoading(false);\n            return res;\n          })\n          .catch((e) => WPStagingLegacyDatabase.showAjaxFatalError(e, '', 'Submit an error report.'))\n      ;\n    },\n    delete() {\n      $('#wpstg--tab--database-backups')\n          .off('click', '.wpstg-delete-backup[data-id]')\n          .on('click', '.wpstg-delete-backup[data-id]', function(e) {\n            e.preventDefault();\n            WPStagingLegacyDatabase.resetErrors();\n            WPStagingLegacyDatabase.isLoading(true);\n            WPStagingLegacyDatabase.cache.get('#wpstg-existing-database-backups').hide();\n            const id = this.getAttribute('data-id');\n            WPStagingLegacyDatabase.ajax(\n                {\n                  action: 'wpstg--backups--database-legacy-delete-confirm',\n                  id: id,\n                  accessToken: wpstg.accessToken,\n                  nonce: wpstg.nonce,\n                },\n                function(response) {\n                  WPStagingLegacyDatabase.showAjaxFatalError(response, '', ' Please submit an error report by using the REPORT ISSUE button.');\n                  WPStagingLegacyDatabase.isLoading(false);\n                  WPStagingLegacyDatabase.cache.get('#wpstg-delete-confirmation').html(response);\n                },\n            );\n          })\n      // Delete final confirmation page\n          .off('click', '#wpstg-delete-backup')\n          .on('click', '#wpstg-delete-backup', function(e) {\n            e.preventDefault();\n            WPStagingLegacyDatabase.resetErrors();\n            WPStagingLegacyDatabase.isLoading(true);\n            const id = this.getAttribute('data-id');\n            WPStagingLegacyDatabase.ajax(\n                {\n                  action: 'wpstg--backups--database-legacy-delete',\n                  id: id,\n                  accessToken: wpstg.accessToken,\n                  nonce: wpstg.nonce,\n                },\n                function(response) {\n                  WPStagingLegacyDatabase.showAjaxFatalError(response, '', ' Please submit an error report by using the REPORT ISSUE button.');\n                  // noinspection JSIgnoredPromiseFromCall\n                  WPStagingLegacyDatabase.fetchListing();\n                  WPStagingLegacyDatabase.isLoading(false);\n                },\n            );\n          })\n          .off('click', '#wpstg-cancel-backup-delete')\n          .on('click', '#wpstg-cancel-backup-delete', function(e) {\n            e.preventDefault();\n            WPStagingLegacyDatabase.isLoading(false);\n            // noinspection JSIgnoredPromiseFromCall\n            WPStagingLegacyDatabase.fetchListing();\n          })\n      ;\n\n      // Force delete if backup tables do not exist\n      // TODO This is bloated, no need extra ID, use existing one?\n      $('#wpstg-error-wrapper')\n          .off('click', '#wpstg-backup-force-delete')\n          .on('click', '#wpstg-backup-force-delete', function(e) {\n            e.preventDefault();\n            WPStagingLegacyDatabase.resetErrors();\n            WPStagingLegacyDatabase.isLoading(true);\n            const id = this.getAttribute('data-id');\n\n            if (!confirm('Do you want to delete this backup ' + id + ' from the listed backups?')) {\n              WPStagingLegacyDatabase.isLoading(false);\n              return false;\n            }\n\n            WPStagingLegacyDatabase.ajax(\n                {\n                  action: 'wpstg--backups--database-legacy-delete',\n                  id: id,\n                  accessToken: wpstg.accessToken,\n                  nonce: wpstg.nonce,\n                },\n                function(response) {\n                  WPStagingLegacyDatabase.showAjaxFatalError(response, '', ' Please submit an error report by using the REPORT ISSUE button.');\n                  // noinspection JSIgnoredPromiseFromCall\n                  WPStagingLegacyDatabase.fetchListing();\n                  WPStagingLegacyDatabase.isLoading(false);\n                },\n            );\n          })\n      ;\n    },\n    restore() {\n      var restoreBackup = function(prefix, reset) {\n        WPStagingLegacyDatabase.isLoading(true);\n        WPStagingLegacyDatabase.resetErrors();\n\n        if (typeof reset === 'undefined') {\n          reset = false;\n        }\n\n        WPStaging.ajax(\n            {\n              action: 'wpstg--backups--database-legacy-restore',\n              accessToken: wpstg.accessToken,\n              nonce: wpstg.nonce,\n              wpstg: {\n                tasks: {\n                  backup: {\n                    database: {\n                      create: {\n                        source: prefix,\n                        reset,\n                      },\n                    },\n                  },\n                },\n              },\n            },\n            function(response) {\n              if (typeof response === 'undefined') {\n                setTimeout(function() {\n                  restoreBackup(prefix);\n                }, wpstg.delayReq);\n                return;\n              }\n\n              WPStagingLegacyDatabase.processResponse(response);\n\n              if (response.status === false || response.job_done === false) {\n                restoreBackup(prefix);\n              } else if (response.status === true && response.job_done === true) {\n                WPStagingLegacyDatabase.isLoading(false);\n                $('.wpstg--modal--process--title').text('Backup successfully restored');\n                setTimeout(() => {\n                  Swal.close();\n                  // noinspection JSIgnoredPromiseFromCall\n                  alert('Backup successfully restored. Please log-in again to WordPress.');\n                  WPStagingLegacyDatabase.fetchListing();\n                }, 1000);\n              } else {\n                setTimeout(function() {\n                  restoreBackup(prefix);\n                }, wpstg.delayReq);\n              }\n            },\n            'json',\n            false,\n            0,\n            1.25,\n        );\n      };\n\n      $('#wpstg--tab--database-backups')\n          .off('click', '.wpstg--backup--restore[data-id]')\n          .on('click', '.wpstg--backup--restore[data-id]', function(e) {\n            e.preventDefault();\n            WPStagingLegacyDatabase.resetErrors();\n            WPStagingLegacyDatabase.ajax(\n                {\n                  action: 'wpstg--backups--database-legacy-restore-confirm',\n                  accessToken: wpstg.accessToken,\n                  nonce: wpstg.nonce,\n                  id: $(this).data('id'),\n                },\n                function(data) {\n                  WPStagingLegacyDatabase.cache.get('#wpstg--tab--database-backups').html(data);\n                },\n            );\n          })\n          .off('click', '#wpstg--backup--restore--cancel')\n          .on('click', '#wpstg--backup--restore--cancel', function(e) {\n            WPStagingLegacyDatabase.resetErrors();\n            e.preventDefault();\n            // noinspection JSIgnoredPromiseFromCall\n            WPStagingLegacyDatabase.fetchListing();\n          })\n          .off('click', '#wpstg--backup--restore[data-id]')\n          .on('click', '#wpstg--backup--restore[data-id]', function(e) {\n            e.preventDefault();\n            WPStagingLegacyDatabase.resetErrors();\n            const id = this.getAttribute('data-id');\n            WPStagingLegacyDatabase.process({\n              execute: () => {\n                WPStagingLegacyDatabase.messages.reset();\n                restoreBackup(id, true);\n              },\n              isShowCancelButton: false,\n            });\n          })\n      ;\n    },\n    // Edit backups name and notes\n    edit() {\n      $('#wpstg--tab--database-backups')\n          .off('click', '.wpstg--backup--edit[data-id]')\n          .on('click', '.wpstg--backup--edit[data-id]', async function(e) {\n            e.preventDefault();\n\n            const name = $(this).data('name');\n            const notes = $(this).data('notes');\n\n            const {value: formValues} = await Swal.fire({\n              title: '',\n              html: `\n                    <label id=\"wpstg-backup-edit-name\">Backup Name</label>\n                    <input id=\"wpstg-backup-edit-name-input\" class=\"swal2-input\" value=\"${name}\">\n                    <label>Additional Notes</label>\n                    <textarea id=\"wpstg-backup-edit-notes-textarea\" class=\"swal2-textarea\">${notes}</textarea>\n                  `,\n              focusConfirm: false,\n              confirmButtonText: 'Update Backup',\n              showCancelButton: true,\n              preConfirm: () => ({\n                name: document.getElementById('wpstg-backup-edit-name-input').value || null,\n                notes: document.getElementById('wpstg-backup-edit-notes-textarea').value || null,\n              }),\n            });\n\n            if (!formValues) {\n              return;\n            }\n\n            WPStagingLegacyDatabase.ajax(\n                {\n                  action: 'wpstg--backups--database-legacy-edit',\n                  accessToken: wpstg.accessToken,\n                  nonce: wpstg.nonce,\n                  id: $(this).data('id'),\n                  name: formValues.name,\n                  notes: formValues.notes,\n                },\n                function(response) {\n                  WPStagingLegacyDatabase.showAjaxFatalError(response, '', 'Submit an error report.');\n                  // noinspection JSIgnoredPromiseFromCall\n                  WPStagingLegacyDatabase.fetchListing();\n                },\n            );\n          })\n      ;\n    },\n    cancel() {\n      WPStagingLegacyDatabase.timer.stop();\n      WPStagingLegacyDatabase.isCancelled = true;\n      Swal.close();\n      setTimeout(() => WPStagingLegacyDatabase.ajax(\n          {\n            action: 'wpstg--backups--cancel',\n            accessToken: wpstg.accessToken,\n            nonce: wpstg.nonce,\n            type: WPStagingLegacyDatabase.type,\n          },\n          function(response) {\n            WPStagingLegacyDatabase.showAjaxFatalError(response, '', 'Submit an error report.');\n          },\n      ), 500);\n    },\n    /**\n   * If process.execute exists, process.data and process.onResponse is not used\n   * process = { data: {}, onResponse: (resp) => {}, onAfterClose: () => {}, execute: () => {}, isShowCancelButton: bool }\n   * @param {object} process\n   */\n    process(process) {\n      if (typeof process.execute !== 'function' && (!process.data || !process.onResponse)) {\n        Swal.close();\n        WPStagingLegacyDatabase.showError('process.data and / or process.onResponse is not set');\n        return;\n      }\n\n      // TODO move to backend and get the contents as xhr response?\n      if (!WPStagingLegacyDatabase.modal.process.html || !WPStagingLegacyDatabase.modal.process.cancelBtnTxt) {\n        const $modal = $('#wpstg--modal--backup--process');\n        const html = $modal.html();\n        const btnTxt = $modal.attr('data-cancelButtonText');\n        WPStagingLegacyDatabase.modal.process.html = html || null;\n        WPStagingLegacyDatabase.modal.process.cancelBtnTxt = btnTxt || null;\n        $modal.remove();\n      }\n\n      $('body')\n          .off('click', '.wpstg--modal--process--logs--tail')\n          .on('click', '.wpstg--modal--process--logs--tail', function(e) {\n            e.preventDefault();\n            const container = Swal.getContainer();\n            const $logs = $(container).find('.wpstg--modal--process--logs');\n            $logs.toggle();\n            if ($logs.is(':visible')) {\n              container.childNodes[0].style.width = '100%';\n              container.style['z-index'] = 9999;\n            } else {\n              container.childNodes[0].style.width = '600px';\n            }\n          })\n      ;\n\n      process.isShowCancelButton = false !== process.isShowCancelButton;\n\n      WPStagingLegacyDatabase.modal.process.modal = Swal.mixin({\n        customClass: {\n          cancelButton: 'wpstg--btn--cancel wpstg-blue-primary wpstg-link-btn',\n          content: 'wpstg--process--content',\n        },\n        buttonsStyling: false,\n      }).fire({\n        html: WPStagingLegacyDatabase.modal.process.html,\n        cancelButtonText: WPStagingLegacyDatabase.modal.process.cancelBtnTxt,\n        showCancelButton: process.isShowCancelButton,\n        showConfirmButton: false,\n        allowOutsideClick: false,\n        allowEscapeKey: false,\n        width: 600,\n        onRender: () => {\n          const _btnCancel = Swal.getContainer().getElementsByClassName('swal2-cancel wpstg--btn--cancel')[0];\n          const btnCancel = _btnCancel.cloneNode(true);\n          _btnCancel.parentNode.replaceChild(btnCancel, _btnCancel);\n\n          btnCancel.addEventListener('click', function(e) {\n            if (confirm('Are You Sure? This will cancel the process!')) {\n              Swal.close();\n            }\n          });\n\n          if (typeof process.execute === 'function') {\n            process.execute();\n            return;\n          }\n\n          if (!process.data || !process.onResponse) {\n            Swal.close();\n            WPStagingLegacyDatabase.showError('process.data and / or process.onResponse is not set');\n            return;\n          }\n\n          WPStagingLegacyDatabase.ajax(process.data, process.onResponse);\n        },\n        onAfterClose: () => typeof process.onAfterClose === 'function' && process.onAfterClose(),\n        onClose: () => {\n          console.log('cancelled');\n          WPStagingLegacyDatabase.cancel();\n        },\n      });\n    },\n    processResponse(response, useTitle) {\n      if (response === null) {\n        Swal.close();\n        WPStagingLegacyDatabase.showError('Invalid Response; null');\n        throw new Error(`Invalid Response; ${response}`);\n      }\n\n      const $container = $(Swal.getContainer());\n      const title = () => {\n        if ((response.title || response.statusTitle) && useTitle === true) {\n          $container.find('.wpstg--modal--process--title').text(response.title || response.statusTitle);\n        }\n      };\n      const percentage = () => {\n        if (response.percentage) {\n          $container.find('.wpstg--modal--process--percent').text(response.percentage);\n        }\n      };\n      const logs = () => {\n        if (!response.messages) {\n          return;\n        }\n        const $logsContainer = $container.find('.wpstg--modal--process--logs');\n        const stoppingTypes = [\n          WPStagingLegacyDatabase.messages.ERROR,\n          WPStagingLegacyDatabase.messages.CRITICAL,\n        ];\n        const appendMessage = (message) => {\n          if (Array.isArray(message)) {\n            for (const item of message) {\n              appendMessage(item);\n            }\n            return;\n          }\n          const msgClass = `wpstg--modal--process--msg--${message.type.toLowerCase()}`;\n          $logsContainer.append(`<p class=\"${msgClass}\">[${message.type}] - [${message.date}] - ${message.message}</p>`);\n\n          if (stoppingTypes.includes(message.type.toLowerCase())) {\n            WPStagingLegacyDatabase.cancel();\n            setTimeout(WPStagingLegacyDatabase.logsModal, 500);\n          }\n        };\n        for (const message of response.messages) {\n          if (!message) {\n            continue;\n          }\n          WPStagingLegacyDatabase.messages.addMessage(message);\n          appendMessage(message);\n        }\n\n        if ($logsContainer.is(':visible')) {\n          $logsContainer.scrollTop($logsContainer[0].scrollHeight);\n        }\n\n        if (!WPStagingLegacyDatabase.messages.shouldWarn()) {\n          return;\n        }\n\n        const $btnShowLogs = $container.find('.wpstg--modal--process--logs--tail');\n        $btnShowLogs.html($btnShowLogs.attr('data-txt-bad'));\n\n        $btnShowLogs\n            .find('.wpstg--modal--logs--critical-count')\n            .text(WPStagingLegacyDatabase.messages.countByType(WPStagingLegacyDatabase.messages.CRITICAL))\n        ;\n\n        $btnShowLogs\n            .find('.wpstg--modal--logs--error-count')\n            .text(WPStagingLegacyDatabase.messages.countByType(WPStagingLegacyDatabase.messages.ERROR))\n        ;\n\n        $btnShowLogs\n            .find('.wpstg--modal--logs--warning-count')\n            .text(WPStagingLegacyDatabase.messages.countByType(WPStagingLegacyDatabase.messages.WARNING))\n        ;\n      };\n\n      title();\n      percentage();\n      logs();\n\n      if (response.status === true && response.job_done === true) {\n        WPStagingLegacyDatabase.timer.stop();\n        WPStagingLegacyDatabase.isCancelled = true;\n      }\n    },\n    requestData(notation, data) {\n      const obj = {};\n      const keys = notation.split('.');\n      const lastIndex = keys.length - 1;\n      keys.reduce((accumulated, current, index) => {\n        return accumulated[current] = index >= lastIndex ? data : {};\n      }, obj);\n      return obj;\n    },\n    logsModal() {\n      Swal.fire({\n        html: `<div class=\"wpstg--modal--error--logs\" style=\"display:block\"></div><div class=\"wpstg--modal--process--logs\" style=\"display:block\"></div>`,\n        width: '95%',\n        onRender: () => {\n          const $container = $(Swal.getContainer());\n          $container[0].style['z-index'] = 9999;\n\n          const $logsContainer = $container.find('.wpstg--modal--process--logs');\n          const $errorContainer = $container.find('.wpstg--modal--error--logs');\n          const $translations = $('#wpstg--js--translations');\n          const messages = WPStagingLegacyDatabase.messages;\n          const title = $translations.attr('data-modal-logs-title')\n              .replace('{critical}', messages.countByType(messages.CRITICAL))\n              .replace('{errors}', messages.countByType(messages.ERROR))\n              .replace('{warnings}', messages.countByType(messages.WARNING))\n        ;\n\n          $errorContainer.before(`<h3>${title}</h3>`);\n          const warnings = [\n            WPStagingLegacyDatabase.messages.CRITICAL,\n            WPStagingLegacyDatabase.messages.ERROR,\n            WPStagingLegacyDatabase.messages.WARNING,\n          ];\n\n          if (!WPStagingLegacyDatabase.messages.shouldWarn()) {\n            $errorContainer.hide();\n          }\n\n          for (const message of messages.data.all) {\n            const msgClass = `wpstg--modal--process--msg--${message.type.toLowerCase()}`;\n            // TODO RPoC\n            if (warnings.includes(message.type)) {\n              $errorContainer.append(\n                  `<p class=\"${msgClass}\">[${message.type}] - [${message.date}] - ${message.message}</p>`,\n              );\n            }\n            $logsContainer.append(\n                `<p class=\"${msgClass}\">[${message.type}] - [${message.date}] - ${message.message}</p>`,\n            );\n          }\n        },\n        onOpen: (container) => {\n          const $logsContainer = $(container).find('.wpstg--modal--process--logs');\n          $logsContainer.scrollTop($logsContainer[0].scrollHeight);\n        },\n      });\n    },\n    downloadModal({title = null, titleExport = null, id = null, url = null, btnTxtCancel = 'Cancel', btnTxtConfirm = 'Download'}) {\n      if (null === WPStagingLegacyDatabase.modal.download.html) {\n        const $el = $('#wpstg--modal--backup--download');\n        WPStagingLegacyDatabase.modal.download.html = $el.html();\n        $el.remove();\n      }\n\n      const exportModal = () => Swal.fire({\n        html: `<h2>${titleExport}</h2><span class=\"wpstg-loader\"></span>`,\n        showCancelButton: false,\n        showConfirmButton: false,\n        onRender: () => {\n          WPStagingLegacyDatabase.ajax(\n              {\n                action: 'wpstg--backups--database-legacy-export',\n                accessToken: wpstg.accessToken,\n                nonce: wpstg.nonce,\n                id,\n              },\n              function(response) {\n                console.log(response);\n                if (!response || !response.success || !response.data || response.data.length < 1) {\n                  return;\n                }\n\n                const a = document.createElement('a');\n                a.style.display = 'none';\n                a.href = response.data;\n                document.body.appendChild(a);\n                a.click();\n                document.body.removeChild(a);\n\n                Swal.close();\n              },\n          );\n        },\n      });\n\n      Swal.mixin({\n        customClass: {\n          cancelButton: 'wpstg--btn--cancel wpstg-blue-primary wpstg-link-btn',\n          confirmButton: 'wpstg--btn--confirm wpstg-blue-primary wpstg-button wpstg-link-btn',\n          actions: 'wpstg--modal--actions',\n        },\n        buttonsStyling: false,\n      })\n          .fire({\n            icon: 'success',\n            html: WPStagingLegacyDatabase.modal.download.html.replace('{title}', title).replace('{btnTxtLog}', 'Show Logs'),\n            cancelButtonText: btnTxtCancel,\n            confirmButtonText: btnTxtConfirm,\n            showCancelButton: true,\n            showConfirmButton: true,\n          })\n          .then((isConfirm) => {\n            if (!isConfirm || !isConfirm.value) {\n              return;\n            }\n\n            if (url && url.length > 0) {\n              window.location.href = url;\n              return;\n            }\n\n            exportModal();\n          })\n      ;\n    },\n    importModal() {\n      const restoreSiteBackup = (data) => {\n        WPStagingLegacyDatabase.resetErrors();\n\n        if (WPStagingLegacyDatabase.isCancelled) {\n          console.log('cancelled');\n          // Swal.close();\n          return;\n        }\n\n        const reset = data['reset'];\n        delete data['reset'];\n        data['mergeMediaFiles'] = 1; // always merge for uploads / media\n        let requestData = Object.assign({}, data);\n\n        requestData = WPStagingLegacyDatabase.requestData(\n            'jobs.backup.site.restore',\n            {...WPStagingLegacyDatabase.modal.import.data},\n        );\n\n        WPStagingLegacyDatabase.timer.start();\n\n        const statusStop = () => {\n          console.log('Status: Stop');\n          clearInterval(WPStagingLegacyDatabase.processInfo.interval);\n          WPStagingLegacyDatabase.processInfo.interval = null;\n        };\n        const status = () => {\n          if (WPStagingLegacyDatabase.processInfo.interval !== null) {\n            return;\n          }\n          console.log('Status: Start');\n          WPStagingLegacyDatabase.processInfo.interval = setInterval(() => {\n            if (true === WPStagingLegacyDatabase.isCancelled) {\n              statusStop();\n              return;\n            }\n\n            if (WPStagingLegacyDatabase.status.hasResponse === false) {\n              return;\n            }\n\n            WPStagingLegacyDatabase.status.hasResponse = false;\n            fetch(`${ajaxurl}?action=wpstg--backups--status&process=restore&accessToken=${wpstg.accessToken}&nonce=${wpstg.nonce}`)\n                .then((res) => res.json())\n                .then((res) => {\n                  WPStagingLegacyDatabase.status.hasResponse = true;\n                  if (typeof res === 'undefined') {\n                    statusStop();\n                  }\n\n                  if (WPStagingLegacyDatabase.processInfo.title === res.currentStatusTitle) {\n                    return;\n                  }\n\n                  WPStagingLegacyDatabase.processInfo.title = res.currentStatusTitle;\n                  const $container = $(Swal.getContainer());\n                  $container.find('.wpstg--modal--process--title').text(res.currentStatusTitle);\n                  $container.find('.wpstg--modal--process--percent').text('0');\n                })\n                .catch((e) => {\n                  WPStagingLegacyDatabase.status.hasResponse = true;\n                  WPStagingLegacyDatabase.showAjaxFatalError(e, '', 'Submit an error report.');\n                })\n            ;\n          }, 5000);\n        };\n\n        WPStaging.ajax(\n            {\n              action: 'wpstg--backups--database-legacy-restore',\n              accessToken: wpstg.accessToken,\n              nonce: wpstg.nonce,\n              reset,\n              wpstg: requestData,\n            },\n            function(response) {\n              if (typeof response === 'undefined') {\n                setTimeout(function() {\n                  restoreSiteBackup(data);\n                }, wpstg.delayReq);\n                return;\n              }\n\n              WPStagingLegacyDatabase.processResponse(response, true);\n              if (!WPStagingLegacyDatabase.processInfo.interval) {\n                status();\n              }\n\n              if (response.status === false) {\n                restoreSiteBackup(data);\n              } else if (response.status === true) {\n                $('#wpstg--progress--status').text('Backup successfully restored!');\n                WPStagingLegacyDatabase.type = null;\n                if (WPStagingLegacyDatabase.messages.shouldWarn()) {\n                  // noinspection JSIgnoredPromiseFromCall\n                  WPStagingLegacyDatabase.fetchListing();\n                  WPStagingLegacyDatabase.logsModal();\n                  return;\n                }\n                statusStop();\n                const logEntries = $('.wpstg--modal--process--logs').get(1).innerHTML;\n                const html = '<div class=\"wpstg--modal--process--logs\">' + logEntries + '</div>';\n                const issueFound = html.includes('wpstg--modal--process--msg--warning') || html.includes('wpstg--modal--process--msg--error') ? 'Issues(s) found! ' : '';\n                console.log('errors found: ' + issueFound);\n                // var errorMessage = html.includes('wpstg--modal--process--msg--error') ? 'Errors(s) found! ' : '';\n                // var Message = warningMessage + errorMessage;\n\n                // Swal.close();\n                Swal.fire({\n                  icon: 'success',\n                  title: 'Finished',\n                  html: 'System restored from backup. <br/><span class=\"wpstg--modal--process--msg-found\">' + issueFound + '</span><button class=\"wpstg--modal--process--logs--tail\" data-txt-bad=\"\">Show Logs</button><br/>' + html,\n                },\n                );\n\n                // noinspection JSIgnoredPromiseFromCall\n                WPStagingLegacyDatabase.fetchListing();\n              } else {\n                setTimeout(function() {\n                  restoreSiteBackup(data);\n                }, wpstg.delayReq);\n              }\n            },\n            'json',\n            false,\n            0, // Don't retry upon failure\n            1.25,\n        );\n      };\n\n      if (!WPStagingLegacyDatabase.modal.import.html) {\n        const $modal = $('#wpstg--modal--backup--import');\n\n        // Search & Replace Form\n        const $form = $modal.find('.wpstg--modal--backup--import--search-replace--input--container');\n        WPStagingLegacyDatabase.modal.import.searchReplaceForm = $form.html();\n        $form.find('.wpstg--modal--backup--import--search-replace--input-group').remove();\n        $form.html(WPStagingLegacyDatabase.modal.import.searchReplaceForm.replace(/{i}/g, 0));\n\n        WPStagingLegacyDatabase.modal.import.html = $modal.html();\n        WPStagingLegacyDatabase.modal.import.baseDirectory = $modal.attr('data-baseDirectory');\n        WPStagingLegacyDatabase.modal.import.btnTxtNext = $modal.attr('data-nextButtonText');\n        WPStagingLegacyDatabase.modal.import.btnTxtConfirm = $modal.attr('data-confirmButtonText');\n        WPStagingLegacyDatabase.modal.import.btnTxtCancel = $modal.attr('data-cancelButtonText');\n        $modal.remove();\n      }\n\n      WPStagingLegacyDatabase.modal.import.data.search = [];\n      WPStagingLegacyDatabase.modal.import.data.replace = [];\n\n      let $btnConfirm = null;\n      Swal\n          .mixin({\n            customClass: {\n              confirmButton: 'wpstg--btn--confirm wpstg-blue-primary wpstg-button wpstg-link-btn',\n              cancelButton: 'wpstg--btn--cancel wpstg-blue-primary wpstg-link-btn',\n              actions: 'wpstg--modal--actions',\n            },\n            buttonsStyling: false,\n            // progressSteps: ['1', '2']\n          })\n          .queue([{\n            html: WPStagingLegacyDatabase.modal.import.html,\n            confirmButtonText: WPStagingLegacyDatabase.modal.import.btnTxtNext,\n            showCancelButton: false,\n            showConfirmButton: true,\n            showLoaderOnConfirm: true,\n            width: 650,\n            onRender() {\n              $btnConfirm = $('.wpstg--modal--actions .swal2-confirm');\n              $btnConfirm.prop('disabled', true);\n\n              WPStagingLegacyDatabase.modal.import.containerUpload = $('.wpstg--modal--backup--import--upload');\n              WPStagingLegacyDatabase.modal.import.containerFilesystem = $('.wpstg--modal--backup--import--filesystem');\n            },\n            preConfirm() {\n              const body = new FormData;\n              body.append('accessToken', wpstg.accessToken);\n              body.append('nonce', wpstg.nonce);\n              body.append('filePath', WPStagingLegacyDatabase.modal.import.data.file);\n\n              WPStagingLegacyDatabase.modal.import.data.search.forEach((item, index) => {\n                body.append(`search[${index}]`, item);\n              });\n              WPStagingLegacyDatabase.modal.import.data.replace.forEach((item, index) => {\n                body.append(`replace[${index}]`, item);\n              });\n\n              return fetch(`${ajaxurl}?action=wpstg--backups--import--file-info`, {\n                method: 'POST',\n                body,\n              }).then(WPStagingLegacyDatabase.handleFetchErrors)\n                  .then((res) => res.json())\n                  .then((html) => {\n                    return Swal.insertQueueStep({\n                      html: html,\n                      confirmButtonText: WPStagingLegacyDatabase.modal.import.btnTxtConfirm,\n                      cancelButtonText: WPStagingLegacyDatabase.modal.import.btnTxtCancel,\n                      showCancelButton: true,\n                    });\n                  })\n                  .catch((e) => WPStagingLegacyDatabase.showAjaxFatalError(e, '', 'Submit an error report.'))\n              ;\n            },\n          }])\n          .then((res) => {\n            if (!res || !res.value || !res.value[1] || res.value[1] !== true) {\n              return;\n            }\n\n            WPStagingLegacyDatabase.isCancelled = false;\n            const data = WPStagingLegacyDatabase.modal.import.data;\n            data['file'] = WPStagingLegacyDatabase.modal.import.baseDirectory + data['file'];\n            data['reset'] = true;\n\n            WPStagingLegacyDatabase.process({\n              execute: () => {\n                WPStagingLegacyDatabase.messages.reset();\n                restoreSiteBackup(data);\n              },\n            });\n          })\n      ;\n    },\n  };\n}(jQuery));\n"],"names":["$","window","addEventListener","WPStagingLegacyDatabase","init","type","isCancelled","processInfo","title","interval","cache","elements","get","selector","inArray","refresh","fetchListing","create","restore","edit","off","on","$records","find","value","show","filter","hide","url","getAttribute","length","location","href","downloadModal","titleExport","id","btnTxtCancel","btnTxtConfirm","importModal","$parent","parent","hasClass","addClass","text","attr","removeClass","e","preventDefault","$container","Swal","getContainer","total","append","modal","searchReplaceForm","replace","index","parseInt","isNaN","data","search","option","click","containerFilesystem","containerUpload","$containerFilesystem","fetch","ajaxurl","Math","random","wpstg","accessToken","nonce","then","handleFetchErrors","res","json","$ul","empty","isEmpty","forEach","file","fullPath","name","size","showAjaxFatalError","setFile","files","prop","stopPropagation","originalEvent","dataTransfer","createBackup","resetErrors","reset","requestData","Object","assign","useResponseTitle","jobs","backup","site","directories","wpContentDir","excludedDirectories","availableDirectories","split","item","includedDirectories","includes","map","includeOtherFilesInWpContent","wpStagingDir","close","showError","timer","start","statusStop","console","log","clearInterval","status","setInterval","hasResponse","currentStatusTitle","WPStaging","ajax","action","response","setTimeout","delayReq","processResponse","messages","shouldWarn","logsModal","backupId","$el","$logsContainer","all","message","msgClass","toLowerCase","date","$body","advancedOptions","$target","toggle","is","totalDirs","isExportDatabase","html","confirmBtnTxt","$newBackupModal","btnTxt","remove","fire","focusConfirm","confirmButtonText","showCancelButton","preConfirm","container","querySelector","notes","Array","from","querySelectorAll","i","exportDatabase","formValues","process","execute","obj","hasOwnProperty","isLoading","prependMessage","appendMessage","removeEventListener","warnIfClosingDuringProcess","error","ok","statusText","css","callback","dataType","showErrors","tryCount","incrementRatio","retryLimit","retryTimeout","Date","now","xhr","textStatus","errorThrown","errorCode","success","statusCode","cancelBtnTxt","download","btnTxtNext","upload","toUnit","bytes","floor","pow","toFixed","baseDirectory","WARNING","ERROR","INFO","DEBUG","CRITICAL","info","critical","warning","debug","countByType","addMessage","isArray","push","totalSeconds","prettify","seconds","toISOString","substr","stop","reader","iop","uploadInfo","isShow","$containerUpload","$containerUploader","FileReader","sendChunk","startsAt","isReset","endsAt","blob","slice","onloadend","event","target","readyState","DONE","body","FormData","result","method","writtenBytes","percent","readAsDataURL","reTryAfter","isResetErrors","confirm","restoreBackup","prefix","tasks","database","source","job_done","alert","isShowCancelButton","document","getElementById","cancel","onResponse","$modal","$logs","childNodes","style","width","mixin","customClass","cancelButton","content","buttonsStyling","cancelButtonText","showConfirmButton","allowOutsideClick","allowEscapeKey","onRender","_btnCancel","getElementsByClassName","btnCancel","cloneNode","parentNode","replaceChild","onAfterClose","onClose","useTitle","Error","statusTitle","percentage","logs","stoppingTypes","scrollTop","scrollHeight","$btnShowLogs","notation","keys","lastIndex","reduce","accumulated","current","$errorContainer","$translations","before","warnings","onOpen","exportModal","a","createElement","display","appendChild","removeChild","confirmButton","actions","icon","isConfirm","restoreSiteBackup","logEntries","innerHTML","issueFound","$form","$btnConfirm","queue","showLoaderOnConfirm","insertQueueStep","jQuery"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAC,WAASA,CAAT,EAAY;EACXC,EAAAA,MAAM,CAACC,gBAAP,CAAwB,sBAAxB,EAAgD,YAAW;EACzDC,IAAAA,uBAAuB,CAACC,IAAxB;EACD,GAFD;EAIA,MAAMD,uBAAuB,GAAG;EAC9BE,IAAAA,IAAI,EAAE,IADwB;EAE9BC,IAAAA,WAAW,EAAE,KAFiB;EAG9BC,IAAAA,WAAW,EAAE;EACXC,MAAAA,KAAK,EAAE,IADI;EAEXC,MAAAA,QAAQ,EAAE;EAFC,KAHiB;EAO9BC,IAAAA,KAAK,EAAE;EACLC,MAAAA,QAAQ,EAAE,EADL;EAELC,MAAAA,GAAG,EAAE,aAASC,QAAT,EAAmB;EACxB;EACE,YAAIb,CAAC,CAACc,OAAF,CAAUD,QAAV,EAAoB,KAAKF,QAAzB,MAAuC,CAAC,CAA5C,EAA+C;EAC7C,iBAAO,KAAKA,QAAL,CAAcE,QAAd,CAAP;EACD,SAJqB;;;EAOtB,aAAKF,QAAL,CAAcE,QAAd,IAA0Bb,CAAC,CAACa,QAAD,CAA3B;EAEA,eAAO,KAAKF,QAAL,CAAcE,QAAd,CAAP;EACD,OAZI;EAaLE,MAAAA,OAAO,EAAE,iBAASF,QAAT,EAAmB;EAC1BA,QAAAA,QAAQ,CAACF,QAAT,CAAkBE,QAAlB,IAA8Bb,CAAC,CAACa,QAAD,CAA/B;EACD;EAfI,KAPuB;EAwB9BT,IAAAA,IAxB8B,kBAwBvB;EACLD,MAAAA,uBAAuB,CAACa,YAAxB;EACA,WAAKC,MAAL;EACA;EACA,WAAKC,OAAL;EACA,WAAKC,IAAL,GALK;;EAULnB,MAAAA,CAAC,CAAC,MAAD,CAAD,CACKoB,GADL,CACS,QADT,EACmB,yBADnB,EAEKC,EAFL,CAEQ,QAFR,EAEkB,yBAFlB,EAE6C,YAAW;EAClD,YAAMC,QAAQ,GAAGtB,CAAC,CAAC,kCAAD,CAAD,CAAsCuB,IAAtC,CAA2C,mCAA3C,CAAjB;;EACA,YAAI,KAAKC,KAAL,KAAe,EAAnB,EAAuB;EACrBF,UAAAA,QAAQ,CAACG,IAAT;EACD,SAFD,MAEO,IAAI,KAAKD,KAAL,KAAe,UAAnB,EAA+B;EACpCF,UAAAA,QAAQ,CAACI,MAAT,CAAgB,oBAAhB,EAAsCC,IAAtC;EACAL,UAAAA,QAAQ,CAACI,MAAT,CAAgB,wBAAhB,EAA0CD,IAA1C;EACD,SAHM,MAGA,IAAI,KAAKD,KAAL,KAAe,MAAnB,EAA2B;EAChCF,UAAAA,QAAQ,CAACI,MAAT,CAAgB,wBAAhB,EAA0CC,IAA1C;EACAL,UAAAA,QAAQ,CAACI,MAAT,CAAgB,oBAAhB,EAAsCD,IAAtC;EACD;EACF,OAbL,EAcKJ,EAdL,CAcQ,OAdR,EAciB,0BAdjB,EAc6C,YAAW;EAClD,YAAMO,GAAG,GAAG,KAAKC,YAAL,CAAkB,UAAlB,CAAZ;;EACA,YAAID,GAAG,CAACE,MAAJ,GAAa,CAAjB,EAAoB;EAClB7B,UAAAA,MAAM,CAAC8B,QAAP,CAAgBC,IAAhB,GAAuBJ,GAAvB;EACA;EACD;;EACDzB,QAAAA,uBAAuB,CAAC8B,aAAxB,CAAsC;EACpCC,UAAAA,WAAW,EAAE,KAAKL,YAAL,CAAkB,mBAAlB,CADuB;EAEpCrB,UAAAA,KAAK,EAAE,KAAKqB,YAAL,CAAkB,YAAlB,CAF6B;EAGpCM,UAAAA,EAAE,EAAE,KAAKN,YAAL,CAAkB,SAAlB,CAHgC;EAIpCO,UAAAA,YAAY,EAAE,KAAKP,YAAL,CAAkB,qBAAlB,CAJsB;EAKpCQ,UAAAA,aAAa,EAAE,KAAKR,YAAL,CAAkB,uBAAlB;EALqB,SAAtC;EAOD,OA3BL,EA4BKT,GA5BL,CA4BS,OA5BT,EA4BkB,sBA5BlB,EA6BKC,EA7BL,CA6BQ,OA7BR,EA6BiB,sBA7BjB,EA6ByC,YAAW;EAC9ClB,QAAAA,uBAAuB,CAACmC,WAAxB;EACD,OA/BL;EAAA,OAiCKlB,GAjCL,CAiCS,OAjCT,EAiCkB,uCAjClB,EAkCKC,EAlCL,CAkCQ,OAlCR,EAkCiB,uCAlCjB,EAkC0D,YAAW;EAC/D,YAAMkB,OAAO,GAAGvC,CAAC,CAAC,IAAD,CAAD,CAAQwC,MAAR,EAAhB;;EACA,YAAI,CAACD,OAAO,CAACE,QAAR,CAAiB,qBAAjB,CAAL,EAA8C;EAC5CF,UAAAA,OAAO,CAACG,QAAR,CAAiB,qBAAjB;EACA1C,UAAAA,CAAC,CAAC,IAAD,CAAD,CAAQ2C,IAAR,CAAa3C,CAAC,CAAC,IAAD,CAAD,CAAQ4C,IAAR,CAAa,gBAAb,CAAb;EACD,SAHD,MAGO;EACLL,UAAAA,OAAO,CAACM,WAAR,CAAoB,qBAApB;EACA7C,UAAAA,CAAC,CAAC,IAAD,CAAD,CAAQ2C,IAAR,CAAa3C,CAAC,CAAC,IAAD,CAAD,CAAQ4C,IAAR,CAAa,eAAb,CAAb;EACD;EACF,OA3CL,EA4CKxB,GA5CL,CA4CS,OA5CT,EA4CkB,oDA5ClB,EA6CKC,EA7CL,CA6CQ,OA7CR,EA6CiB,oDA7CjB,EA6CuE,UAASyB,CAAT,EAAY;EAC7EA,QAAAA,CAAC,CAACC,cAAF;EACA,YAAMC,UAAU,GAAGhD,CAAC,CAACiD,IAAI,CAACC,YAAL,EAAD,CAAD,CAAuB3B,IAAvB,CAA4B,iEAA5B,CAAnB;EACA,YAAM4B,KAAK,GAAGH,UAAU,CAACzB,IAAX,CAAgB,4DAAhB,EAA8EO,MAA5F;EACAkB,QAAAA,UAAU,CAACI,MAAX,CAAkBjD,uBAAuB,CAACkD,KAAxB,WAAqCC,iBAArC,CAAuDC,OAAvD,CAA+D,MAA/D,EAAuEJ,KAAvE,CAAlB;EACD,OAlDL,EAmDK/B,GAnDL,CAmDS,OAnDT,EAmDkB,gCAnDlB,EAoDKC,EApDL,CAoDQ,OApDR,EAoDiB,gCApDjB,EAoDmD,YAAW;EACxD,YAAMmC,KAAK,GAAGC,QAAQ,CAAC,KAAK5B,YAAL,CAAkB,YAAlB,CAAD,CAAtB;;EACA,YAAI,CAAC6B,KAAK,CAACF,KAAD,CAAV,EAAmB;EACjBrD,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CC,MAA1C,CAAiDJ,KAAjD,IAA0D,KAAKhC,KAA/D;EACD;EACF,OAzDL,EA0DKJ,GA1DL,CA0DS,OA1DT,EA0DkB,iCA1DlB,EA2DKC,EA3DL,CA2DQ,OA3DR,EA2DiB,iCA3DjB,EA2DoD,YAAW;EACzD,YAAMmC,KAAK,GAAGC,QAAQ,CAAC,KAAK5B,YAAL,CAAkB,YAAlB,CAAD,CAAtB;;EACA,YAAI,CAAC6B,KAAK,CAACF,KAAD,CAAV,EAAmB;EACjBrD,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CJ,OAA1C,CAAkDC,KAAlD,IAA2D,KAAKhC,KAAhE;EACD;EACF,OAhEL;EAAA,OAkEKJ,GAlEL,CAkES,OAlET,EAkEkB,6CAlElB,EAmEKC,EAnEL,CAmEQ,OAnER,EAmEiB,6CAnEjB,EAmEgE,YAAW;EACrE,YAAMwC,MAAM,GAAG,KAAKhC,YAAL,CAAkB,aAAlB,CAAf;;EAEA,YAAIgC,MAAM,KAAK,MAAf,EAAuB;EACrB7D,UAAAA,CAAC,CAAC,gEAAD,CAAD,CAAoE8D,KAApE;EACA;EACD;;EAED,YAAID,MAAM,KAAK,QAAf,EAAyB;EACvB1D,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCU,mBAArC,CAAyDpC,IAAzD;EACAxB,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCW,eAArC,CAAqDvC,IAArD;EACAzB,UAAAA,CAAC,CAAC,uCAAD,CAAD,CAA2C8D,KAA3C;EACA9D,UAAAA,CAAC,CAAC,wDAAD,CAAD,CAA4DyB,IAA5D;EACD;;EAED,YAAIoC,MAAM,KAAK,YAAf,EAA6B;EAC3B;EACD;;EAED1D,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCW,eAArC,CAAqDrC,IAArD;EACA,YAAMsC,oBAAoB,GAAG9D,uBAAuB,CAACkD,KAAxB,WAAqCU,mBAAlE;EACAE,QAAAA,oBAAoB,CAACxC,IAArB;EAEAyC,QAAAA,KAAK,CAAIC,OAAJ,oDAA0DC,IAAI,CAACC,MAAL,EAA1D,qBAAuFC,KAAK,CAACC,WAA7F,eAAkHD,KAAK,CAACE,KAAxH,CAAL,CACKC,IADL,CACUtE,uBAAuB,CAACuE,iBADlC,EAEKD,IAFL,CAEU,UAACE,GAAD;EAAA,iBAASA,GAAG,CAACC,IAAJ,EAAT;EAAA,SAFV,EAGKH,IAHL,CAGU,UAACE,GAAD,EAAS;EACb,cAAME,GAAG,GAAG7E,CAAC,CAAC,8CAAD,CAAb;EACA6E,UAAAA,GAAG,CAACC,KAAJ;;EAEA,cAAI,CAACH,GAAD,IAAQxE,uBAAuB,CAAC4E,OAAxB,CAAgCJ,GAAhC,CAAZ,EAAkD;EAChDE,YAAAA,GAAG,CAACzB,MAAJ;EACApD,YAAAA,CAAC,CAAC,wDAAD,CAAD,CAA4D2B,IAA5D;EACA;EACD;;EAEDkD,UAAAA,GAAG,CAACzB,MAAJ;EACAuB,UAAAA,GAAG,CAACK,OAAJ,CAAY,UAASC,IAAT,EAAezB,KAAf,EAAsB;EAClC;EACEqB,YAAAA,GAAG,CAACzB,MAAJ,2EAA8E6B,IAAI,CAACC,QAAnF,WAAgGD,IAAI,CAACE,IAArG,gBAAoHF,IAAI,CAACG,IAAzH;EACD,WAHD,EAXa;;EAgBb,iBAAOT,GAAP;EACD,SApBL,WAqBW,UAAC7B,CAAD;EAAA,iBAAO3C,uBAAuB,CAACkF,kBAAxB,CAA2CvC,CAA3C,EAA8C,EAA9C,EAAkD,yBAAlD,CAAP;EAAA,SArBX;EAuBD,OAjHL,EAkHK1B,GAlHL,CAkHS,QAlHT,EAkHmB,gEAlHnB,EAmHKC,EAnHL,CAmHQ,QAnHR,EAmHkB,gEAnHlB,EAmHoF,YAAW;EACzFlB,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCiC,OAArC,CAA6C,KAAKC,KAAL,CAAW,CAAX,KAAiB,IAA9D;EACAvF,QAAAA,CAAC,CAAC,uCAAD,CAAD,CAA2C8D,KAA3C;EACD,OAtHL,EAuHK1C,GAvHL,CAuHS,QAvHT,EAuHmB,gDAvHnB,EAwHKC,EAxHL,CAwHQ,QAxHR,EAwHkB,gDAxHlB,EAwHoE,YAAW;EACzErB,QAAAA,CAAC,CAAC,uCAAD,CAAD,CAA2CwF,IAA3C,CAAgD,UAAhD,EAA4D,KAA5D;EACArF,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CsB,IAA1C,GAAiD,KAAKzD,KAAtD;EACD,OA3HL;EAAA,OA6HKH,EA7HL,CA6HQ,0DA7HR,EA6HoE,kDA7HpE,EA6HwH,UAASyB,CAAT,EAAY;EAC9HA,QAAAA,CAAC,CAACC,cAAF;EACAD,QAAAA,CAAC,CAAC2C,eAAF;EACD,OAhIL,EAiIKpE,EAjIL,CAiIQ,oBAjIR,EAiI8B,kDAjI9B,EAiIkF,YAAW;EACvFrB,QAAAA,CAAC,CAAC,IAAD,CAAD,CAAQ0C,QAAR,CAAiB,qBAAjB;EACD,OAnIL,EAoIKrB,EApIL,CAoIQ,wBApIR,EAoIkC,kDApIlC,EAoIsF,YAAW;EAC3FrB,QAAAA,CAAC,CAAC,IAAD,CAAD,CAAQ6C,WAAR,CAAoB,qBAApB;EACD,OAtIL,EAuIKxB,EAvIL,CAuIQ,MAvIR,EAuIgB,kDAvIhB,EAuIoE,UAASyB,CAAT,EAAY;EAC1E3C,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCiC,OAArC,CAA6CxC,CAAC,CAAC4C,aAAF,CAAgBC,YAAhB,CAA6BJ,KAA7B,CAAmC,CAAnC,KAAyC,IAAtF;EACD,OAzIL;EA2ID,KA7K6B;EA8K9BtE,IAAAA,MA9K8B,oBA8KrB;EACP,UAAI2E,YAAY,GAAG,SAAfA,YAAe,CAASjC,IAAT,EAAe;EAChCxD,QAAAA,uBAAuB,CAAC0F,WAAxB;;EAEA,YAAI1F,uBAAuB,CAACG,WAA5B,EAAyC;EACzC;EACE;EACD;;EAED,YAAMwF,KAAK,GAAGnC,IAAI,CAAC,OAAD,CAAlB;EACA,eAAOA,IAAI,CAAC,OAAD,CAAX;EACA,YAAIoC,WAAW,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBtC,IAAlB,CAAlB;EACA,YAAIuC,gBAAgB,GAAG,IAAvB;;EAEA,YAAIvC,IAAI,CAACtD,IAAL,KAAc,UAAlB,EAA8B;EAC5BF,UAAAA,uBAAuB,CAACE,IAAxB,GAA+BsD,IAAI,CAACtD,IAApC,CAD4B;EAI5B;;EACA,iBAAO0F,WAAW,CAAC,qBAAD,CAAlB;EACA,iBAAOA,WAAW,CAAC,cAAD,CAAlB;EACA,iBAAOA,WAAW,CAAC,sBAAD,CAAlB;EACA,iBAAOA,WAAW,CAAC,cAAD,CAAlB;EACA,iBAAOA,WAAW,CAAC,gBAAD,CAAlB;EACA,iBAAOA,WAAW,CAAC,8BAAD,CAAlB;EAEAA,UAAAA,WAAW,GAAG5F,uBAAuB,CAAC4F,WAAxB,CACV,8BADU,eAENA,WAFM;EAEO1F,YAAAA,IAAI,EAAE;EAFb,aAAd;EAID,SAhBD,MAgBO,IAAIsD,IAAI,CAACtD,IAAL,KAAc,MAAlB,EAA0B;EAC/BF,UAAAA,uBAAuB,CAACE,IAAxB,GAA+BsD,IAAI,CAACtD,IAApC,CAD+B;EAI/B;;EACA,iBAAO0F,WAAW,CAAC,MAAD,CAAlB;EAEAA,UAAAA,WAAW,GAAG5F,uBAAuB,CAAC4F,WAAxB,CACV,yBADU,EAEVA,WAFU,CAAd;EAIAG,UAAAA,gBAAgB,GAAG,KAAnB;EACAH,UAAAA,WAAW,CAACI,IAAZ,CAAiBC,MAAjB,CAAwBC,IAAxB,CAA6BpF,MAA7B,CAAoCqF,WAApC,GAAkD,CAChD3C,IAAI,CAAC4C,YAD2C,CAAlD;EAGAR,UAAAA,WAAW,CAACI,IAAZ,CAAiBC,MAAjB,CAAwBC,IAAxB,CAA6BpF,MAA7B,CAAoCuF,mBAApC,GAA0D7C,IAAI,CAAC8C,oBAAL,CACrDC,KADqD,CAC/C,GAD+C,EAErDhF,MAFqD,CAE9C,UAACiF,IAAD;EAAA,mBAAU,CAAChD,IAAI,CAACiD,mBAAL,CAAyBC,QAAzB,CAAkCF,IAAlC,CAAX;EAAA,WAF8C,EAGrDG,GAHqD,CAGjD,UAACH,IAAD;EAAA,mBAAUA,IAAV;EAAA,WAHiD,CAA1D;EAKAZ,UAAAA,WAAW,CAACI,IAAZ,CAAiBC,MAAjB,CAAwBC,IAAxB,CAA6BpF,MAA7B,CAAoC8F,4BAApC,GAAmE,CACjEpD,IAAI,CAACoD,4BAD4D,CAAnE,CApB+B;EAyB/B;EACA;EAEA;;EACA,iBAAOhB,WAAW,CAACI,IAAZ,CAAiBC,MAAjB,CAAwBC,IAAxB,CAA6BpF,MAA7B,CAAoCsF,YAA3C;EACA,iBAAOR,WAAW,CAACI,IAAZ,CAAiBC,MAAjB,CAAwBC,IAAxB,CAA6BpF,MAA7B,CAAoC+F,YAA3C;EACA,iBAAOjB,WAAW,CAACI,IAAZ,CAAiBC,MAAjB,CAAwBC,IAAxB,CAA6BpF,MAA7B,CAAoCwF,oBAA3C;EACD,SAhCM,MAgCA;EACLtG,UAAAA,uBAAuB,CAACE,IAAxB,GAA+B,IAA/B;EACA4C,UAAAA,IAAI,CAACgE,KAAL;EACA9G,UAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,qBAAlC;EACA;EACD;;EAED/G,QAAAA,uBAAuB,CAACgH,KAAxB,CAA8BC,KAA9B;;EAEA,YAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;EACvBC,UAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;EACAC,UAAAA,aAAa,CAACrH,uBAAuB,CAACI,WAAxB,CAAoCE,QAArC,CAAb;EACAN,UAAAA,uBAAuB,CAACI,WAAxB,CAAoCE,QAApC,GAA+C,IAA/C;EACD,SAJD;;EAKA,YAAMgH,MAAM,GAAG,SAATA,MAAS,GAAM;EACnB,cAAItH,uBAAuB,CAACI,WAAxB,CAAoCE,QAApC,KAAiD,IAArD,EAA2D;EACzD;EACD;;EACD6G,UAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;EACApH,UAAAA,uBAAuB,CAACI,WAAxB,CAAoCE,QAApC,GAA+CiH,WAAW,CAAC,YAAM;EAC/D,gBAAI,SAASvH,uBAAuB,CAACG,WAArC,EAAkD;EAChD+G,cAAAA,UAAU;EACV;EACD;;EAED,gBAAIlH,uBAAuB,CAACsH,MAAxB,CAA+BE,WAA/B,KAA+C,KAAnD,EAA0D;EACxD;EACD;;EAEDxH,YAAAA,uBAAuB,CAACsH,MAAxB,CAA+BE,WAA/B,GAA6C,KAA7C;EACAzD,YAAAA,KAAK,CAAIC,OAAJ,mDAAyDG,KAAK,CAACC,WAA/D,eAAoFD,KAAK,CAACE,KAA1F,CAAL,CACKC,IADL,CACU,UAACE,GAAD;EAAA,qBAASA,GAAG,CAACC,IAAJ,EAAT;EAAA,aADV,EAEKH,IAFL,CAEU,UAACE,GAAD,EAAS;EACbxE,cAAAA,uBAAuB,CAACsH,MAAxB,CAA+BE,WAA/B,GAA6C,IAA7C;;EACA,kBAAI,OAAOhD,GAAP,KAAe,WAAnB,EAAgC;EAC9B0C,gBAAAA,UAAU;EACX;;EAED,kBAAIlH,uBAAuB,CAACI,WAAxB,CAAoCC,KAApC,KAA8CmE,GAAG,CAACiD,kBAAtD,EAA0E;EACxE;EACD;;EAEDzH,cAAAA,uBAAuB,CAACI,WAAxB,CAAoCC,KAApC,GAA4CmE,GAAG,CAACiD,kBAAhD;EACA,kBAAM5E,UAAU,GAAGhD,CAAC,CAACiD,IAAI,CAACC,YAAL,EAAD,CAApB;EACAF,cAAAA,UAAU,CAACzB,IAAX,CAAgB,+BAAhB,EAAiDoB,IAAjD,CAAsDgC,GAAG,CAACiD,kBAA1D;EACA5E,cAAAA,UAAU,CAACzB,IAAX,CAAgB,iCAAhB,EAAmDoB,IAAnD,CAAwD,GAAxD;EACD,aAhBL,WAiBW,UAACG,CAAD,EAAO;EACZ3C,cAAAA,uBAAuB,CAACsH,MAAxB,CAA+BE,WAA/B,GAA6C,IAA7C;EACAxH,cAAAA,uBAAuB,CAACkF,kBAAxB,CAA2CvC,CAA3C,EAA8C,EAA9C,EAAkD,yBAAlD;EACD,aApBL;EAsBD,WAjCyD,EAiCvD,IAjCuD,CAA1D;EAkCD,SAvCD;;EAyCA+E,QAAAA,SAAS,CAACC,IAAV,CACI;EACEC,UAAAA,MAAM,EAAE,wCADV;EAEExD,UAAAA,WAAW,EAAED,KAAK,CAACC,WAFrB;EAGEC,UAAAA,KAAK,EAAEF,KAAK,CAACE,KAHf;EAIEsB,UAAAA,KAAK,EAALA,KAJF;EAKExB,UAAAA,KAAK,EAAEyB;EALT,SADJ,EAQI,UAASiC,QAAT,EAAmB;EACjB,cAAI,OAAOA,QAAP,KAAoB,WAAxB,EAAqC;EACnCC,YAAAA,UAAU,CAAC,YAAW;EACpBrC,cAAAA,YAAY,CAACjC,IAAD,CAAZ;EACD,aAFS,EAEPW,KAAK,CAAC4D,QAFC,CAAV;EAGA;EACD;;EAED/H,UAAAA,uBAAuB,CAACgI,eAAxB,CAAwCH,QAAxC,EAAkD9B,gBAAlD;;EACA,cAAI,CAACA,gBAAD,IAAqB,CAAC/F,uBAAuB,CAACI,WAAxB,CAAoCE,QAA9D,EAAwE;EACtEgH,YAAAA,MAAM;EACP;;EAED,cAAIO,QAAQ,CAACP,MAAT,KAAoB,KAAxB,EAA+B;EAC7B7B,YAAAA,YAAY,CAACjC,IAAD,CAAZ;EACD,WAFD,MAEO,IAAIqE,QAAQ,CAACP,MAAT,KAAoB,IAAxB,EAA8B;EACnCzH,YAAAA,CAAC,CAAC,0BAAD,CAAD,CAA8B2C,IAA9B,CAAmC,8BAAnC;EACAxC,YAAAA,uBAAuB,CAACE,IAAxB,GAA+B,IAA/B;;EACA,gBAAIF,uBAAuB,CAACiI,QAAxB,CAAiCC,UAAjC,EAAJ,EAAmD;EACjD;EACAlI,cAAAA,uBAAuB,CAACa,YAAxB;EACAb,cAAAA,uBAAuB,CAACmI,SAAxB;EACA;EACD;;EACDjB,YAAAA,UAAU;EACVpE,YAAAA,IAAI,CAACgE,KAAL;EACA9G,YAAAA,uBAAuB,CAACa,YAAxB,GACKyD,IADL,CACU,YAAM;EACV,kBAAI,CAACuD,QAAQ,CAACO,QAAd,EAAwB;EACtBpI,gBAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,uCAAlC;EACA;EACD,eAJS;;;EAOV,kBAAMsB,GAAG,GAAGxI,CAAC,yCAAsCgI,QAAQ,CAACO,QAA/C,SAAb;EACApI,cAAAA,uBAAuB,CAAC8B,aAAxB,CAAsC;EACpCE,gBAAAA,EAAE,EAAEqG,GAAG,CAAC7E,IAAJ,CAAS,IAAT,CADgC;EAEpC/B,gBAAAA,GAAG,EAAE4G,GAAG,CAAC7E,IAAJ,CAAS,KAAT,CAF+B;EAGpCnD,gBAAAA,KAAK,EAAEgI,GAAG,CAAC7E,IAAJ,CAAS,OAAT,CAH6B;EAIpCzB,gBAAAA,WAAW,EAAEsG,GAAG,CAAC7E,IAAJ,CAAS,cAAT,CAJuB;EAKpCvB,gBAAAA,YAAY,EAAEoG,GAAG,CAAC7E,IAAJ,CAAS,gBAAT,CALsB;EAMpCtB,gBAAAA,aAAa,EAAEmG,GAAG,CAAC7E,IAAJ,CAAS,kBAAT;EANqB,eAAtC;EAQA3D,cAAAA,CAAC,CAAC,wCAAD,CAAD,CAA4CyB,IAA5C;EACA,kBAAMgH,cAAc,GAAGzI,CAAC,CAAC,8BAAD,CAAxB;EACAG,cAAAA,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,CAAsC+E,GAAtC,CAA0C1D,OAA1C,CAAkD,UAAC2D,OAAD,EAAa;EAC7D,oBAAMC,QAAQ,oCAAkCD,OAAO,CAACtI,IAAR,CAAawI,WAAb,EAAhD;EACAJ,gBAAAA,cAAc,CACTrF,MADL,iBACyBwF,QADzB,YACuCD,OAAO,CAACtI,IAD/C,aAC2DsI,OAAO,CAACG,IADnE,YAC8EH,OAAO,CAACA,OADtF;EAGD,eALD;EAMD,aAzBL;EA2BD,WAtCM,MAsCA;EACLV,YAAAA,UAAU,CAAC,YAAW;EACpBrC,cAAAA,YAAY,CAACjC,IAAD,CAAZ;EACD,aAFS,EAEPW,KAAK,CAAC4D,QAFC,CAAV;EAGD;EACF,SAlEL,EAmEI,MAnEJ,EAoEI,KApEJ,EAqEI,CArEJ;EAsEI,YAtEJ;EAwED,OA5LD;;EA8LA,UAAMa,KAAK,GAAG/I,CAAC,CAAC,MAAD,CAAf;EAEA+I,MAAAA,KAAK,CACA3H,GADL,CACS,OADT,EACkB,2BADlB,EAEKC,EAFL,CAEQ,OAFR,EAEiB,2BAFjB,EAE8C,YAAW;EACnD,YAAM2H,eAAe,GAAGhJ,CAAC,CAAC,yBAAD,CAAzB;;EACA,YAAI,KAAKwB,KAAL,KAAe,UAAnB,EAA+B;EAC7BwH,UAAAA,eAAe,CAACrH,IAAhB;EACA;EACD;;EACDqH,QAAAA,eAAe,CAACvH,IAAhB;EACD,OATL,EAUKL,GAVL,CAUS,OAVT,EAUkB,qBAVlB,EAWKC,EAXL,CAWQ,OAXR,EAWiB,qBAXjB,EAWwC,YAAW;EAC7C,YAAM4H,OAAO,GAAGjJ,CAAC,CAACA,CAAC,CAAC,IAAD,CAAD,CAAQ4C,IAAR,CAAa,aAAb,CAAD,CAAjB;EACAqG,QAAAA,OAAO,CAACC,MAAR;;EACA,YAAID,OAAO,CAACE,EAAR,CAAW,UAAX,CAAJ,EAA4B;EAC1BnJ,UAAAA,CAAC,CAAC,IAAD,CAAD,CAAQuB,IAAR,CAAa,MAAb,EAAqBoB,IAArB,CAA0B,GAA1B;EACD,SAFD,MAEO;EACL3C,UAAAA,CAAC,CAAC,IAAD,CAAD,CAAQuB,IAAR,CAAa,MAAb,EAAqBoB,IAArB,CAA0B,GAA1B;EACD;EACF,OAnBL,EAoBKvB,GApBL,CAoBS,QApBT,EAoBmB,6EApBnB,EAqBKC,EArBL,CAqBQ,QArBR,EAqBkB,8FArBlB,EAqBkH,YAAW;EACvH,YAAM+H,SAAS,GAAGpJ,CAAC,CAAC,2DAAD,CAAD,CAA+D8B,MAAjF;EACA,YAAMuH,gBAAgB,GAAGrJ,CAAC,CAAC,mDAAD,CAAD,CAAuD8B,MAAvD,KAAkE,CAA3F;;EACA,YAAIsH,SAAS,GAAG,CAAZ,IAAiB,CAACC,gBAAtB,EAAwC;EACtCrJ,UAAAA,CAAC,CAAC,gBAAD,CAAD,CAAoBwF,IAApB,CAAyB,UAAzB,EAAqC,IAArC;EACD,SAFD,MAEO;EACLxF,UAAAA,CAAC,CAAC,gBAAD,CAAD,CAAoBwF,IAApB,CAAyB,UAAzB,EAAqC,KAArC;EACD;EACF,OA7BL,EAjMO;;EAkOPxF,MAAAA,CAAC,CAAC,+BAAD,CAAD,CACKoB,GADL,CACS,OADT,EACkB,4BADlB,EAEKC,EAFL,CAEQ,OAFR,EAEiB,4BAFjB;EAAA,2EAE+C,iBAAeyB,CAAf;EAAA;;EAAA;EAAA;EAAA;EAAA;EACzC3C,kBAAAA,uBAAuB,CAAC0F,WAAxB;EACA/C,kBAAAA,CAAC,CAACC,cAAF;EACA5C,kBAAAA,uBAAuB,CAACG,WAAxB,GAAsC,KAAtC;;EAEA,sBAAI,CAACH,uBAAuB,CAACkD,KAAxB,CAA8BpC,MAA9B,CAAqCqI,IAAtC,IAA8C,CAACnJ,uBAAuB,CAACkD,KAAxB,CAA8BpC,MAA9B,CAAqCsI,aAAxF,EAAuG;EAC/FC,oBAAAA,eAD+F,GAC7ExJ,CAAC,CAAC,8BAAD,CAD4E;EAE/FsJ,oBAAAA,IAF+F,GAExFE,eAAe,CAACF,IAAhB,EAFwF;EAG/FG,oBAAAA,MAH+F,GAGtFD,eAAe,CAAC5G,IAAhB,CAAqB,wBAArB,CAHsF;EAIrGzC,oBAAAA,uBAAuB,CAACkD,KAAxB,CAA8BpC,MAA9B,CAAqCqI,IAArC,GAA4CA,IAAI,IAAI,IAApD;EACAnJ,oBAAAA,uBAAuB,CAACkD,KAAxB,CAA8BpC,MAA9B,CAAqCsI,aAArC,GAAqDE,MAAM,IAAI,IAA/D;EACAD,oBAAAA,eAAe,CAACE,MAAhB;EACD;;EAZwC;EAAA,yBAcPzG,IAAI,CAAC0G,IAAL,CAAU;EAC1CnJ,oBAAAA,KAAK,EAAE,EADmC;EAE1C8I,oBAAAA,IAAI,EAAEnJ,uBAAuB,CAACkD,KAAxB,CAA8BpC,MAA9B,CAAqCqI,IAFD;EAG1CM,oBAAAA,YAAY,EAAE,KAH4B;EAI1CC,oBAAAA,iBAAiB,EAAE1J,uBAAuB,CAACkD,KAAxB,CAA8BpC,MAA9B,CAAqCsI,aAJd;EAK1CO,oBAAAA,gBAAgB,EAAE,IALwB;EAM1CC,oBAAAA,UAAU,EAAE,sBAAM;EAChB,0BAAMC,SAAS,GAAG/G,IAAI,CAACC,YAAL,EAAlB;EAEA,6BAAO;EACL7C,wBAAAA,IAAI,EAAE,UADD;EAEL8E,wBAAAA,IAAI,EAAE6E,SAAS,CAACC,aAAV,CAAwB,2BAAxB,EAAqDzI,KAArD,IAA8D,IAF/D;EAGL0I,wBAAAA,KAAK,EAAEF,SAAS,CAACC,aAAV,CAAwB,8BAAxB,EAAwDzI,KAAxD,IAAiE,IAHnE;EAILoF,wBAAAA,mBAAmB,EAAEuD,KAAK,CAACC,IAAN,CAAYJ,SAAS,CAACK,gBAAV,CAA2B,iDAA3B,KAAiF,EAA7F,EAAkGvD,GAAlG,CAAsG,UAACwD,CAAD;EAAA,iCAAOA,CAAC,CAAC9I,KAAT;EAAA,yBAAtG,CAJhB;EAKL+E,wBAAAA,YAAY,EAAEyD,SAAS,CAACC,aAAV,CAAwB,4BAAxB,EAAsDzI,KAAtD,IAA+D,IALxE;EAMLiF,wBAAAA,oBAAoB,EAAEuD,SAAS,CAACC,aAAV,CAAwB,oCAAxB,EAA8DzI,KAA9D,IAAuE,IANxF;EAOLwF,wBAAAA,YAAY,EAAEgD,SAAS,CAACC,aAAV,CAAwB,4BAAxB,EAAsDzI,KAAtD,IAA+D,IAPxE;EAQL+I,wBAAAA,cAAc,EAAEP,SAAS,CAACC,aAAV,CAAwB,uCAAxB,MAAqE,IARhF;EASLlD,wBAAAA,4BAA4B,EAAEiD,SAAS,CAACC,aAAV,CAAwB,oDAAxB,MAAkF;EAT3G,uBAAP;EAWD;EApByC,mBAAV,CAdO;;EAAA;EAAA;EAc3BO,kBAAAA,UAd2B,oBAclChJ,KAdkC;;EAAA,sBAqCpCgJ,UArCoC;EAAA;EAAA;EAAA;;EAAA;;EAAA;EAyCzCA,kBAAAA,UAAU,CAAC1E,KAAX,GAAmB,IAAnB;EAEA3F,kBAAAA,uBAAuB,CAACsK,OAAxB,CAAgC;EAC9BC,oBAAAA,OAAO,EAAE,mBAAM;EACbvK,sBAAAA,uBAAuB,CAACiI,QAAxB,CAAiCtC,KAAjC;EACAF,sBAAAA,YAAY,CAAC4E,UAAD,CAAZ;EACD;EAJ6B,mBAAhC;;EA3CyC;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA,SAF/C;;EAAA;EAAA;EAAA;EAAA;EAqDD,KArc6B;EAsc9BzF,IAAAA,OAAO,EAAE,iBAAS4F,GAAT,EAAc;EACrB,WAAK,IAAMnF,IAAX,IAAmBmF,GAAnB,EAAwB;EACtB,YAAIA,GAAG,CAACC,cAAJ,CAAmBpF,IAAnB,CAAJ,EAA8B;EAC5B,iBAAO,KAAP;EACD;EACF;;EAED,aAAO,IAAP;EACD,KA9c6B;EA+c9BqF,IAAAA,SAAS,EAAE,mBAASA,UAAT,EAAoB;EAC7B,UAAI,CAACA,UAAD,IAAcA,UAAS,KAAK,KAAhC,EAAuC;EACrC1K,QAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,eAAlC,EAAmDe,IAAnD;EACD,OAFD,MAEO;EACLxB,QAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,eAAlC,EAAmDa,IAAnD;EACD;EACF,KArd6B;EAsd9B4D,IAAAA,kBAAkB,EAAE,4BAAS2C,QAAT,EAAmB8C,cAAnB,EAAmCC,aAAnC,EAAkD;EACpED,MAAAA,cAAc,GAAGA,cAAc,GAAGA,cAAc,GAAG,YAApB,GAAmC,kCAAlE;EACAC,MAAAA,aAAa,GAAGA,aAAa,GAAGA,aAAa,GAAG,YAAnB,GAAkC,0MAA/D;;EAEA,UAAI/C,QAAQ,KAAK,KAAjB,EAAwB;EACtB7H,QAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC4D,cAAc,GAAG,sBAAjB,GAA0CC,aAA5E;EACA9K,QAAAA,MAAM,CAAC+K,mBAAP,CAA2B,cAA3B,EAA2CnD,SAAS,CAACoD,0BAArD;EACA;EACD;;EAED,UAAI,OAAOjD,QAAQ,CAACkD,KAAhB,KAA0B,WAA1B,IAAyClD,QAAQ,CAACkD,KAAtD,EAA6D;EAC3D5D,QAAAA,OAAO,CAAC4D,KAAR,CAAclD,QAAQ,CAACW,OAAvB;EACAxI,QAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC4D,cAAc,GAAG,UAAjB,GAA8B9C,QAAQ,CAACW,OAAvC,GAAiDoC,aAAnF;EACA9K,QAAAA,MAAM,CAAC+K,mBAAP,CAA2B,cAA3B,EAA2CnD,SAAS,CAACoD,0BAArD;EACA;EACD;EACF,KAte6B;EAue9BvG,IAAAA,iBAAiB,EAAE,2BAASsD,QAAT,EAAmB;EACpC,UAAI,CAACA,QAAQ,CAACmD,EAAd,EAAkB;EAChBhL,QAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,YAAYc,QAAQ,CAACP,MAArB,GAA8B,KAA9B,GAAsCO,QAAQ,CAACoD,UAA/C,GAA4D,wCAA9F;EACD;;EACD,aAAOpD,QAAP;EACD,KA5e6B;EA6e9Bd,IAAAA,SAAS,EAAE,mBAASyB,OAAT,EAAkB;EAC3BxI,MAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,kBAAlC,EAAsDyK,GAAtD,CAA0D,SAA1D,EAAqE,cAArE;EACAlL,MAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,uBAAlC,EAA2D+B,IAA3D,CAAgE,OAAhE;EACAxC,MAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,uBAAlC,EAA2Da,IAA3D;EACAtB,MAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,sBAAlC,EAA0Da,IAA1D;EACAtB,MAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,sBAAlC,EAA0Da,IAA1D,GAAiE6H,IAAjE,CAAsEX,OAAtE;EACAxI,MAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,uBAAlC,EAA2DiC,WAA3D,CAAuE,SAAvE;EACA1C,MAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,eAAlC,EAAmDe,IAAnD;EACA3B,MAAAA,CAAC,CAAC,yCAAD,CAAD,CAA6CyB,IAA7C,GAAoD6H,IAApD,CAAyDX,OAAzD;EACD,KAtf6B;EAuf9B9C,IAAAA,WAAW,EAAE,uBAAW;EACtB1F,MAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,sBAAlC,EAA0De,IAA1D,GAAiE2H,IAAjE,CAAsE,EAAtE;EACD,KAzf6B;;EA0f9B;EACJ;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACIxB,IAAAA,IAAI,EAAE,cAASnE,IAAT,EAAe2H,QAAf,EAAyBC,QAAzB,EAAmCC,UAAnC,EAA+CC,QAA/C,EAAyDC,cAAzD,EAAgF;EAAA,UAAvBA,cAAuB;EAAvBA,QAAAA,cAAuB,GAAN,IAAM;EAAA;;EACpF,UAAI,gBAAgB,OAAQH,QAA5B,EAAuC;EACrCA,QAAAA,QAAQ,GAAG,MAAX;EACD;;EAED,UAAI,UAAUC,UAAd,EAA0B;EACxBA,QAAAA,UAAU,GAAG,IAAb;EACD;;EAEDC,MAAAA,QAAQ,GAAG,gBAAgB,OAAQA,QAAxB,GAAoC,CAApC,GAAwCA,QAAnD;EAEA,UAAME,UAAU,GAAG,EAAnB;EAEA,UAAIC,YAAY,GAAG,QAAQH,QAA3B;EAEAC,MAAAA,cAAc,GAAGjI,QAAQ,CAACiI,cAAD,CAAzB;;EACA,UAAI,CAAChI,KAAK,CAACgI,cAAD,CAAV,EAA4B;EAC1BE,QAAAA,YAAY,IAAIF,cAAhB;EACD;;EAED1L,MAAAA,CAAC,CAAC8H,IAAF,CAAO;EACLlG,QAAAA,GAAG,EAAEuC,OAAO,GAAG,6BAAV,GAA2C0H,IAAI,CAACC,GAAL,KAAa,IADxD;EAELzL,QAAAA,IAAI,EAAE,MAFD;EAGLkL,QAAAA,QAAQ,EAAEA,QAHL;EAIL7K,QAAAA,KAAK,EAAE,KAJF;EAKLiD,QAAAA,IAAI,EAAEA,IALD;EAMLuH,QAAAA,KAAK,EAAE,eAASa,GAAT,EAAcC,UAAd,EAA0BC,WAA1B,EAAuC;EAC5C3E,UAAAA,OAAO,CAACC,GAAR,CAAYwE,GAAG,CAACtE,MAAJ,GAAa,GAAb,GAAmBsE,GAAG,CAACX,UAAvB,GAAoC,KAApC,GAA4CY,UAAxD,EAD4C;;EAI5CP,UAAAA,QAAQ;;EACR,cAAIA,QAAQ,IAAIE,UAAhB,EAA4B;EAC1B1D,YAAAA,UAAU,CAAC,YAAW;EACpB9H,cAAAA,uBAAuB,CAAC2H,IAAxB,CAA6BnE,IAA7B,EAAmC2H,QAAnC,EAA6CC,QAA7C,EAAuDC,UAAvD,EAAmEC,QAAnE,EAA6EC,cAA7E;EACA;EACD,aAHS,EAGPE,YAHO,CAAV;EAID,WALD,MAKO;EACL,gBAAMM,SAAS,GAAG,gBAAgB,OAAQH,GAAG,CAACtE,MAA5B,GAAsC,SAAtC,GAAkDsE,GAAG,CAACtE,MAAxE;EACAtH,YAAAA,uBAAuB,CAAC+G,SAAxB,CACI,mBAAmBgF,SAAnB,GAA+B,iMADnC;EAGD;EACF,SAtBI;EAuBLC,QAAAA,OAAO,EAAE,iBAASxI,IAAT,EAAe;EACtB,cAAI,eAAe,OAAQ2H,QAA3B,EAAsC;EACpCA,YAAAA,QAAQ,CAAC3H,IAAD,CAAR;EACD;EACF,SA3BI;EA4BLyI,QAAAA,UAAU,EAAE;EACV,eAAK,aAAW;EACd,gBAAIX,QAAQ,IAAIE,UAAhB,EAA4B;EAC1BxL,cAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,0OAAlC;EACD;EACF,WALS;EAMV,eAAK,aAAW;EACd,gBAAIuE,QAAQ,IAAIE,UAAhB,EAA4B;EAC1BxL,cAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,sQAAlC;EACD;EACF,WAVS;EAWV,eAAK,aAAW;EACd,gBAAIuE,QAAQ,GAAGE,UAAf,EAA2B;EACzBxL,cAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,gUAAlC;EACD;EACF,WAfS;EAgBV,eAAK,aAAW;EACd,gBAAIuE,QAAQ,IAAIE,UAAhB,EAA4B;EAC1BxL,cAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,gUAAlC;EACD;EACF,WApBS;EAqBV,eAAK,aAAW;EACd,gBAAIuE,QAAQ,IAAIE,UAAhB,EAA4B;EAC1BxL,cAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,gUAAlC;EACD;EACF,WAzBS;EA0BV,eAAK,aAAW;EACd,gBAAIuE,QAAQ,IAAIE,UAAhB,EAA4B;EAC1BxL,cAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,gUAAlC;EACD;EACF,WA9BS;EA+BV,eAAK,aAAW;EACd,gBAAIuE,QAAQ,IAAIE,UAAhB,EAA4B;EAC1BxL,cAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,gFAAlC;EACD;EACF;EAnCS;EA5BP,OAAP;EAkED,KAzlB6B;EA0lB9B7D,IAAAA,KAAK,EAAE;EACLpC,MAAAA,MAAM,EAAE;EACNqI,QAAAA,IAAI,EAAE,IADA;EAENC,QAAAA,aAAa,EAAE;EAFT,OADH;EAKLkB,MAAAA,OAAO,EAAE;EACPnB,QAAAA,IAAI,EAAE,IADC;EAEP+C,QAAAA,YAAY,EAAE,IAFP;EAGPhJ,QAAAA,KAAK,EAAE;EAHA,OALJ;EAULiJ,MAAAA,QAAQ,EAAE;EACRhD,QAAAA,IAAI,EAAE;EADE,OAVL;EAaL,gBAAQ;EACNA,QAAAA,IAAI,EAAE,IADA;EAENiD,QAAAA,UAAU,EAAE,IAFN;EAGNlK,QAAAA,aAAa,EAAE,IAHT;EAIND,QAAAA,YAAY,EAAE,IAJR;EAKNkB,QAAAA,iBAAiB,EAAE,IALb;EAMN2B,QAAAA,IAAI,EAAE,IANA;EAONjB,QAAAA,eAAe,EAAE,IAPX;EAQND,QAAAA,mBAAmB,EAAE,IARf;EASNuB,QAAAA,OAAO,EAAE,iBAACL,IAAD,EAAOuH,MAAP,EAAyB;EAAA,cAAlBA,MAAkB;EAAlBA,YAAAA,MAAkB,GAAT,IAAS;EAAA;;EAChC,cAAMC,MAAM,GAAG,SAATA,MAAS,CAACC,KAAD,EAAW;EACxB,gBAAMpC,CAAC,GAAGlG,IAAI,CAACuI,KAAL,CAAWvI,IAAI,CAACmD,GAAL,CAASmF,KAAT,IAAkBtI,IAAI,CAACmD,GAAL,CAAS,IAAT,CAA7B,CAAV;EACA,mBAAO,CAACmF,KAAK,GAAGtI,IAAI,CAACwI,GAAL,CAAS,IAAT,EAAetC,CAAf,CAAT,EAA4BuC,OAA5B,CAAoC,CAApC,IAAyC,CAAzC,GAA6C,GAA7C,GAAmD,CAAC,GAAD,EAAM,IAAN,EAAY,IAAZ,EAAkB,IAAlB,EAAwB,IAAxB,EAA8BvC,CAA9B,CAA1D;EACD,WAHD;;EAKA,cAAI,CAACrF,IAAL,EAAW;EACT;EACD;;EAED9E,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqC4B,IAArC,GAA4CA,IAA5C;EACA9E,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CsB,IAA1C,GAAiDA,IAAI,CAACE,IAAtD;EACAmC,UAAAA,OAAO,CAACC,GAAR,WAAoBtC,IAAI,CAACE,IAAzB;EACAnF,UAAAA,CAAC,CAAC,uCAAD,CAAD,CAA2CsJ,IAA3C,CAAmDrE,IAAI,CAACE,IAAxD,iBAAwEsH,MAAM,CAACxH,IAAI,CAACG,IAAN,CAA9E,QAA8F3D,IAA9F;EACAzB,UAAAA,CAAC,CAAC,cAAD,CAAD,CAAkB2B,IAAlB;EACA3B,UAAAA,CAAC,CAAC,wBAAD,CAAD,CAA4ByB,IAA5B;;EAEA,cAAI+K,MAAJ,EAAY;EACVxM,YAAAA,CAAC,CAAC,uCAAD,CAAD,CAA2CwF,IAA3C,CAAgD,UAAhD,EAA4D,IAA5D;EACArF,YAAAA,uBAAuB,CAACqM,MAAxB,CAA+BpF,KAA/B;EACD;EACF,SA9BK;EA+BN0F,QAAAA,aAAa,EAAE,IA/BT;EAgCNnJ,QAAAA,IAAI,EAAE;EACJsB,UAAAA,IAAI,EAAE,IADF;EAEJrB,UAAAA,MAAM,EAAE,EAFJ;EAGJL,UAAAA,OAAO,EAAE;EAHL;EAhCA;EAbH,KA1lBuB;EA8oB9B6E,IAAAA,QAAQ,EAAE;EACR2E,MAAAA,OAAO,EAAE,SADD;EAERC,MAAAA,KAAK,EAAE,OAFC;EAGRC,MAAAA,IAAI,EAAE,MAHE;EAIRC,MAAAA,KAAK,EAAE,OAJC;EAKRC,MAAAA,QAAQ,EAAE,UALF;EAMRxJ,MAAAA,IAAI,EAAE;EACJ+E,QAAAA,GAAG,EAAE,EADD;EACK;EACT0E,QAAAA,IAAI,EAAE,EAFF;EAGJlC,QAAAA,KAAK,EAAE,EAHH;EAIJmC,QAAAA,QAAQ,EAAE,EAJN;EAKJC,QAAAA,OAAO,EAAE,EALL;EAMJC,QAAAA,KAAK,EAAE;EANH,OANE;EAcRlF,MAAAA,UAdQ,wBAcK;EACX,eAAOlI,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,CAAsCuH,KAAtC,CAA4CpJ,MAA5C,GAAqD,CAArD,IACP3B,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,CAAsC0J,QAAtC,CAA+CvL,MAA/C,GAAwD,CADxD;EAGD,OAlBO;EAmBR0L,MAAAA,WAnBQ,uBAmBInN,IAnBJ,EAmBmD;EAAA,YAA/CA,IAA+C;EAA/CA,UAAAA,IAA+C,GAAxCF,uBAAuB,CAACiI,QAAxB,CAAiC4E,KAAO;EAAA;;EACzD,eAAO7M,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,CAAsCtD,IAAtC,EAA4CyB,MAAnD;EACD,OArBO;EAsBR2L,MAAAA,UAtBQ,sBAsBG9E,OAtBH,EAsBY;EAClB,YAAIwB,KAAK,CAACuD,OAAN,CAAc/E,OAAd,CAAJ,EAA4B;EAC1BA,UAAAA,OAAO,CAAC3D,OAAR,CAAgB,UAAC2B,IAAD,EAAU;EACxBxG,YAAAA,uBAAuB,CAACiI,QAAxB,CAAiCqF,UAAjC,CAA4C9G,IAA5C;EACD,WAFD;EAGA;EACD;;EACD,YAAMtG,IAAI,GAAGsI,OAAO,CAACtI,IAAR,CAAawI,WAAb,MAA8B,MAA3C;;EACA,YAAI,CAAC1I,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,CAAsCtD,IAAtC,CAAL,EAAkD;EAChDF,UAAAA,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,CAAsCtD,IAAtC,IAA8C,EAA9C;EACD;;EACDF,QAAAA,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,CAAsC+E,GAAtC,CAA0CiF,IAA1C,CAA+ChF,OAA/C,EAXkB;;EAYlBxI,QAAAA,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,CAAsCtD,IAAtC,EAA4CsN,IAA5C,CAAiDhF,OAAjD;EACD,OAnCO;EAoCR7C,MAAAA,KApCQ,mBAoCA;EACN3F,QAAAA,uBAAuB,CAACiI,QAAxB,CAAiCzE,IAAjC,GAAwC;EACtC+E,UAAAA,GAAG,EAAE,EADiC;EAEtC0E,UAAAA,IAAI,EAAE,EAFgC;EAGtClC,UAAAA,KAAK,EAAE,EAH+B;EAItCmC,UAAAA,QAAQ,EAAE,EAJ4B;EAKtCC,UAAAA,OAAO,EAAE,EAL6B;EAMtCC,UAAAA,KAAK,EAAE;EAN+B,SAAxC;EAQD;EA7CO,KA9oBoB;EA6rB9BpG,IAAAA,KAAK,EAAE;EACLyG,MAAAA,YAAY,EAAE,CADT;EAELnN,MAAAA,QAAQ,EAAE,IAFL;EAGL2G,MAAAA,KAHK,mBAGG;EACN,YAAI,SAASjH,uBAAuB,CAACgH,KAAxB,CAA8B1G,QAA3C,EAAqD;EACnD;EACD;;EAED,YAAMoN,QAAQ,GAAG,SAAXA,QAAW,CAACC,OAAD,EAAa;EAC5BxG,UAAAA,OAAO,CAACC,GAAR,0BAAmCuG,OAAnC,eAD4B;EAG5B;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EACA,sBAAW,IAAIjC,IAAJ,CAASiC,OAAO,GAAG,IAAnB,CAAD,CAA2BC,WAA3B,GAAyCC,MAAzC,CAAgD,EAAhD,EAAoD,CAApD,CAAV;EACD,SAfD;;EAiBA7N,QAAAA,uBAAuB,CAACgH,KAAxB,CAA8B1G,QAA9B,GAAyCiH,WAAW,CAAC,YAAM;EACzD1H,UAAAA,CAAC,CAAC,sCAAD,CAAD,CAA0C2C,IAA1C,CAA+CkL,QAAQ,CAAC1N,uBAAuB,CAACgH,KAAxB,CAA8ByG,YAA/B,CAAvD;EACAzN,UAAAA,uBAAuB,CAACgH,KAAxB,CAA8ByG,YAA9B;EACD,SAHmD,EAGjD,IAHiD,CAApD;EAID,OA7BI;EA8BLK,MAAAA,IA9BK,kBA8BE;EACL9N,QAAAA,uBAAuB,CAACgH,KAAxB,CAA8ByG,YAA9B,GAA6C,CAA7C;;EACA,YAAIzN,uBAAuB,CAACgH,KAAxB,CAA8B1G,QAAlC,EAA4C;EAC1C+G,UAAAA,aAAa,CAACrH,uBAAuB,CAACgH,KAAxB,CAA8B1G,QAA/B,CAAb;EACAN,UAAAA,uBAAuB,CAACgH,KAAxB,CAA8B1G,QAA9B,GAAyC,IAAzC;EACD;EACF;EApCI,KA7rBuB;EAmuB9B+L,IAAAA,MAAM,EAAE;EACN0B,MAAAA,MAAM,EAAE,IADF;EAENjJ,MAAAA,IAAI,EAAE,IAFA;EAGNkJ,MAAAA,GAAG,EAAE,OAAO,IAHN;EAINC,MAAAA,UAJM,sBAIKC,MAJL,EAIa;EACjB,YAAMC,gBAAgB,GAAGtO,CAAC,CAAC,wCAAD,CAA1B;EACA,YAAMuO,kBAAkB,GAAGvO,CAAC,CAAC,kBAAD,CAA5B;;EACA,YAAIqO,MAAJ,EAAY;EACVC,UAAAA,gBAAgB,CAACjD,GAAjB,CAAqB,SAArB,EAAgC,MAAhC;EACAkD,UAAAA,kBAAkB,CAAC5M,IAAnB;EACA;EACD;;EAED4M,QAAAA,kBAAkB,CAAClD,GAAnB,CAAuB,SAAvB,EAAkC,MAAlC;EACAiD,QAAAA,gBAAgB,CAAC3M,IAAjB;EACD,OAfK;EAgBNyF,MAAAA,KAhBM,mBAgBE;EACNE,QAAAA,OAAO,CAACC,GAAR,WAAoBpH,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CsB,IAA9D;EACA9E,QAAAA,uBAAuB,CAACqM,MAAxB,CAA+B0B,MAA/B,GAAwC,IAAIM,UAAJ,EAAxC;EACArO,QAAAA,uBAAuB,CAACqM,MAAxB,CAA+BvH,IAA/B,GAAsC9E,uBAAuB,CAACkD,KAAxB,WAAqC4B,IAA3E;EACA9E,QAAAA,uBAAuB,CAACqM,MAAxB,CAA+B4B,UAA/B,CAA0C,IAA1C;EACAjO,QAAAA,uBAAuB,CAACqM,MAAxB,CAA+BiC,SAA/B;EACD,OAtBK;EAuBNA,MAAAA,SAvBM,qBAuBIC,QAvBJ,EAuBkB;EAAA,YAAdA,QAAc;EAAdA,UAAAA,QAAc,GAAH,CAAG;EAAA;;EACtB,YAAI,CAACvO,uBAAuB,CAACqM,MAAxB,CAA+BvH,IAApC,EAA0C;EACxC;EACD;;EACD,YAAM0J,OAAO,GAAGD,QAAQ,GAAG,CAA3B;EACA,YAAME,MAAM,GAAGF,QAAQ,GAAGvO,uBAAuB,CAACqM,MAAxB,CAA+B2B,GAA1C,GAAgD,CAA/D;EACA,YAAMU,IAAI,GAAG1O,uBAAuB,CAACqM,MAAxB,CAA+BvH,IAA/B,CAAoC6J,KAApC,CAA0CJ,QAA1C,EAAoDE,MAApD,CAAb;;EACAzO,QAAAA,uBAAuB,CAACqM,MAAxB,CAA+B0B,MAA/B,CAAsCa,SAAtC,GAAkD,UAASC,KAAT,EAAgB;EAChE,cAAIA,KAAK,CAACC,MAAN,CAAaC,UAAb,KAA4BV,UAAU,CAACW,IAA3C,EAAiD;EAC/C;EACD;;EAED,cAAMC,IAAI,GAAG,IAAIC,QAAJ,EAAb;EACAD,UAAAA,IAAI,CAAChM,MAAL,CAAY,aAAZ,EAA2BkB,KAAK,CAACC,WAAjC;EACA6K,UAAAA,IAAI,CAAChM,MAAL,CAAY,OAAZ,EAAqBkB,KAAK,CAACE,KAA3B;EACA4K,UAAAA,IAAI,CAAChM,MAAL,CAAY,MAAZ,EAAoB4L,KAAK,CAACC,MAAN,CAAaK,MAAjC;EACAF,UAAAA,IAAI,CAAChM,MAAL,CAAY,UAAZ,EAAwBjD,uBAAuB,CAACqM,MAAxB,CAA+BvH,IAA/B,CAAoCE,IAA5D;EACAiK,UAAAA,IAAI,CAAChM,MAAL,CAAY,OAAZ,EAAqBuL,OAAO,GAAG,GAAH,GAAS,GAArC;EAGAzK,UAAAA,KAAK,CAAIC,OAAJ,kDAA0D;EAC7DoL,YAAAA,MAAM,EAAE,MADqD;EAE7DH,YAAAA,IAAI,EAAJA;EAF6D,WAA1D,CAAL,CAGG3K,IAHH,CAGQtE,uBAAuB,CAACuE,iBAHhC,EAIKD,IAJL,CAIU,UAACE,GAAD;EAAA,mBAASA,GAAG,CAACC,IAAJ,EAAT;EAAA,WAJV,EAKKH,IALL,CAKU,UAACE,GAAD,EAAS;EACbxE,YAAAA,uBAAuB,CAACkF,kBAAxB,CAA2CV,GAA3C,EAAgD,EAAhD,EAAoD,yBAApD;EACA,gBAAM6K,YAAY,GAAGd,QAAQ,GAAGvO,uBAAuB,CAACqM,MAAxB,CAA+B2B,GAA/D;EACA,gBAAMsB,OAAO,GAAGrL,IAAI,CAACuI,KAAL,CAAY6C,YAAY,GAAGrP,uBAAuB,CAACqM,MAAxB,CAA+BvH,IAA/B,CAAoCG,IAApD,GAA4D,GAAvE,CAAhB;;EACA,gBAAIwJ,MAAM,IAAIzO,uBAAuB,CAACqM,MAAxB,CAA+BvH,IAA/B,CAAoCG,IAAlD,EAAwD;EACtDjF,cAAAA,uBAAuB,CAACqM,MAAxB,CAA+B4B,UAA/B,CAA0C,KAA1C;EACAjO,cAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,KAAlC;EACA7K,cAAAA,CAAC,CAAC,uCAAD,CAAD,CAA2CwF,IAA3C,CAAgD,UAAhD,EAA4D,KAA5D;EACA;EACD;;EACDxF,YAAAA,CAAC,CAAC,uDAAD,CAAD,CAA2D2C,IAA3D,CAAgE8M,OAAhE;EACAzP,YAAAA,CAAC,CAAC,yCAAD,CAAD,CAA6CqL,GAA7C,CAAiD,OAAjD,EAA6DoE,OAA7D;EACAtP,YAAAA,uBAAuB,CAACqM,MAAxB,CAA+BiC,SAA/B,CAAyCG,MAAzC;EACD,WAlBL,WAmBW,UAAC9L,CAAD;EAAA,mBAAO3C,uBAAuB,CAACkF,kBAAxB,CAA2CvC,CAA3C,EAA8C,EAA9C,EAAkD,yBAAlD,CAAP;EAAA,WAnBX;EAqBD,SAlCD;;EAmCA3C,QAAAA,uBAAuB,CAACqM,MAAxB,CAA+B0B,MAA/B,CAAsCwB,aAAtC,CAAoDb,IAApD;EACD;EAlEK,KAnuBsB;EAuyB9BpH,IAAAA,MAAM,EAAE;EACNE,MAAAA,WAAW,EAAE,IADP;EAENgI,MAAAA,UAAU,EAAE;EAFN,KAvyBsB;EA2yB9B3O,IAAAA,YA3yB8B,wBA2yBjB4O,aA3yBiB,EA2yBK;EAAA,UAAtBA,aAAsB;EAAtBA,QAAAA,aAAsB,GAAN,IAAM;EAAA;;EACjCzP,MAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,IAAlC;;EAEA,UAAI+E,aAAJ,EAAmB;EACjBzP,QAAAA,uBAAuB,CAAC0F,WAAxB;EACD;;EAED,aAAO3B,KAAK,CAAIC,OAAJ,0DAAgEC,IAAI,CAACC,MAAL,EAAhE,qBAA6FC,KAAK,CAACC,WAAnG,eAAwHD,KAAK,CAACE,KAA9H,CAAL,CACFC,IADE,CACGtE,uBAAuB,CAACuE,iBAD3B,EAEFD,IAFE,CAEG,UAACE,GAAD;EAAA,eAASA,GAAG,CAACC,IAAJ,EAAT;EAAA,OAFH,EAGFH,IAHE,CAGG,UAACE,GAAD,EAAS;EACbxE,QAAAA,uBAAuB,CAACkF,kBAAxB,CAA2CV,GAA3C,EAAgD,EAAhD,EAAoD,yBAApD;EACAxE,QAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,+BAAlC,EAAmE0I,IAAnE,CAAwE3E,GAAxE;EACAxE,QAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,KAAlC;EACA,eAAOlG,GAAP;EACD,OARE,WASI,UAAC7B,CAAD;EAAA,eAAO3C,uBAAuB,CAACkF,kBAAxB,CAA2CvC,CAA3C,EAA8C,EAA9C,EAAkD,yBAAlD,CAAP;EAAA,OATJ,CAAP;EAWD,KA7zB6B;EAAA,iCA8zBrB;EACP9C,MAAAA,CAAC,CAAC,+BAAD,CAAD,CACKoB,GADL,CACS,OADT,EACkB,+BADlB,EAEKC,EAFL,CAEQ,OAFR,EAEiB,+BAFjB,EAEkD,UAASyB,CAAT,EAAY;EACxDA,QAAAA,CAAC,CAACC,cAAF;EACA5C,QAAAA,uBAAuB,CAAC0F,WAAxB;EACA1F,QAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,IAAlC;EACA1K,QAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,kCAAlC,EAAsEe,IAAtE;EACA,YAAMQ,EAAE,GAAG,KAAKN,YAAL,CAAkB,SAAlB,CAAX;EACA1B,QAAAA,uBAAuB,CAAC2H,IAAxB,CACI;EACEC,UAAAA,MAAM,EAAE,gDADV;EAEE5F,UAAAA,EAAE,EAAEA,EAFN;EAGEoC,UAAAA,WAAW,EAAED,KAAK,CAACC,WAHrB;EAIEC,UAAAA,KAAK,EAAEF,KAAK,CAACE;EAJf,SADJ,EAOI,UAASwD,QAAT,EAAmB;EACjB7H,UAAAA,uBAAuB,CAACkF,kBAAxB,CAA2C2C,QAA3C,EAAqD,EAArD,EAAyD,kEAAzD;EACA7H,UAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,KAAlC;EACA1K,UAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,4BAAlC,EAAgE0I,IAAhE,CAAqEtB,QAArE;EACD,SAXL;EAaD,OArBL;EAAA,OAuBK5G,GAvBL,CAuBS,OAvBT,EAuBkB,sBAvBlB,EAwBKC,EAxBL,CAwBQ,OAxBR,EAwBiB,sBAxBjB,EAwByC,UAASyB,CAAT,EAAY;EAC/CA,QAAAA,CAAC,CAACC,cAAF;EACA5C,QAAAA,uBAAuB,CAAC0F,WAAxB;EACA1F,QAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,IAAlC;EACA,YAAM1I,EAAE,GAAG,KAAKN,YAAL,CAAkB,SAAlB,CAAX;EACA1B,QAAAA,uBAAuB,CAAC2H,IAAxB,CACI;EACEC,UAAAA,MAAM,EAAE,wCADV;EAEE5F,UAAAA,EAAE,EAAEA,EAFN;EAGEoC,UAAAA,WAAW,EAAED,KAAK,CAACC,WAHrB;EAIEC,UAAAA,KAAK,EAAEF,KAAK,CAACE;EAJf,SADJ,EAOI,UAASwD,QAAT,EAAmB;EACjB7H,UAAAA,uBAAuB,CAACkF,kBAAxB,CAA2C2C,QAA3C,EAAqD,EAArD,EAAyD,kEAAzD,EADiB;;EAGjB7H,UAAAA,uBAAuB,CAACa,YAAxB;EACAb,UAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,KAAlC;EACD,SAZL;EAcD,OA3CL,EA4CKzJ,GA5CL,CA4CS,OA5CT,EA4CkB,6BA5ClB,EA6CKC,EA7CL,CA6CQ,OA7CR,EA6CiB,6BA7CjB,EA6CgD,UAASyB,CAAT,EAAY;EACtDA,QAAAA,CAAC,CAACC,cAAF;EACA5C,QAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,KAAlC,EAFsD;;EAItD1K,QAAAA,uBAAuB,CAACa,YAAxB;EACD,OAlDL,EADO;EAuDP;;EACAhB,MAAAA,CAAC,CAAC,sBAAD,CAAD,CACKoB,GADL,CACS,OADT,EACkB,4BADlB,EAEKC,EAFL,CAEQ,OAFR,EAEiB,4BAFjB,EAE+C,UAASyB,CAAT,EAAY;EACrDA,QAAAA,CAAC,CAACC,cAAF;EACA5C,QAAAA,uBAAuB,CAAC0F,WAAxB;EACA1F,QAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,IAAlC;EACA,YAAM1I,EAAE,GAAG,KAAKN,YAAL,CAAkB,SAAlB,CAAX;;EAEA,YAAI,CAACgO,OAAO,CAAC,uCAAuC1N,EAAvC,GAA4C,2BAA7C,CAAZ,EAAuF;EACrFhC,UAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,KAAlC;EACA,iBAAO,KAAP;EACD;;EAED1K,QAAAA,uBAAuB,CAAC2H,IAAxB,CACI;EACEC,UAAAA,MAAM,EAAE,wCADV;EAEE5F,UAAAA,EAAE,EAAEA,EAFN;EAGEoC,UAAAA,WAAW,EAAED,KAAK,CAACC,WAHrB;EAIEC,UAAAA,KAAK,EAAEF,KAAK,CAACE;EAJf,SADJ,EAOI,UAASwD,QAAT,EAAmB;EACjB7H,UAAAA,uBAAuB,CAACkF,kBAAxB,CAA2C2C,QAA3C,EAAqD,EAArD,EAAyD,kEAAzD,EADiB;;EAGjB7H,UAAAA,uBAAuB,CAACa,YAAxB;EACAb,UAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,KAAlC;EACD,SAZL;EAcD,OA3BL;EA6BD,KAn5B6B;EAo5B9B3J,IAAAA,OAp5B8B,qBAo5BpB;EACR,UAAI4O,aAAa,GAAG,SAAhBA,aAAgB,CAASC,MAAT,EAAiBjK,KAAjB,EAAwB;EAC1C3F,QAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,IAAlC;EACA1K,QAAAA,uBAAuB,CAAC0F,WAAxB;;EAEA,YAAI,OAAOC,KAAP,KAAiB,WAArB,EAAkC;EAChCA,UAAAA,KAAK,GAAG,KAAR;EACD;;EAED+B,QAAAA,SAAS,CAACC,IAAV,CACI;EACEC,UAAAA,MAAM,EAAE,yCADV;EAEExD,UAAAA,WAAW,EAAED,KAAK,CAACC,WAFrB;EAGEC,UAAAA,KAAK,EAAEF,KAAK,CAACE,KAHf;EAIEF,UAAAA,KAAK,EAAE;EACL0L,YAAAA,KAAK,EAAE;EACL5J,cAAAA,MAAM,EAAE;EACN6J,gBAAAA,QAAQ,EAAE;EACRhP,kBAAAA,MAAM,EAAE;EACNiP,oBAAAA,MAAM,EAAEH,MADF;EAENjK,oBAAAA,KAAK,EAALA;EAFM;EADA;EADJ;EADH;EADF;EAJT,SADJ,EAkBI,UAASkC,QAAT,EAAmB;EACjB,cAAI,OAAOA,QAAP,KAAoB,WAAxB,EAAqC;EACnCC,YAAAA,UAAU,CAAC,YAAW;EACpB6H,cAAAA,aAAa,CAACC,MAAD,CAAb;EACD,aAFS,EAEPzL,KAAK,CAAC4D,QAFC,CAAV;EAGA;EACD;;EAED/H,UAAAA,uBAAuB,CAACgI,eAAxB,CAAwCH,QAAxC;;EAEA,cAAIA,QAAQ,CAACP,MAAT,KAAoB,KAApB,IAA6BO,QAAQ,CAACmI,QAAT,KAAsB,KAAvD,EAA8D;EAC5DL,YAAAA,aAAa,CAACC,MAAD,CAAb;EACD,WAFD,MAEO,IAAI/H,QAAQ,CAACP,MAAT,KAAoB,IAApB,IAA4BO,QAAQ,CAACmI,QAAT,KAAsB,IAAtD,EAA4D;EACjEhQ,YAAAA,uBAAuB,CAAC0K,SAAxB,CAAkC,KAAlC;EACA7K,YAAAA,CAAC,CAAC,+BAAD,CAAD,CAAmC2C,IAAnC,CAAwC,8BAAxC;EACAsF,YAAAA,UAAU,CAAC,YAAM;EACfhF,cAAAA,IAAI,CAACgE,KAAL,GADe;;EAGfmJ,cAAAA,KAAK,CAAC,iEAAD,CAAL;EACAjQ,cAAAA,uBAAuB,CAACa,YAAxB;EACD,aALS,EAKP,IALO,CAAV;EAMD,WATM,MASA;EACLiH,YAAAA,UAAU,CAAC,YAAW;EACpB6H,cAAAA,aAAa,CAACC,MAAD,CAAb;EACD,aAFS,EAEPzL,KAAK,CAAC4D,QAFC,CAAV;EAGD;EACF,SA5CL,EA6CI,MA7CJ,EA8CI,KA9CJ,EA+CI,CA/CJ,EAgDI,IAhDJ;EAkDD,OA1DD;;EA4DAlI,MAAAA,CAAC,CAAC,+BAAD,CAAD,CACKoB,GADL,CACS,OADT,EACkB,kCADlB,EAEKC,EAFL,CAEQ,OAFR,EAEiB,kCAFjB,EAEqD,UAASyB,CAAT,EAAY;EAC3DA,QAAAA,CAAC,CAACC,cAAF;EACA5C,QAAAA,uBAAuB,CAAC0F,WAAxB;EACA1F,QAAAA,uBAAuB,CAAC2H,IAAxB,CACI;EACEC,UAAAA,MAAM,EAAE,iDADV;EAEExD,UAAAA,WAAW,EAAED,KAAK,CAACC,WAFrB;EAGEC,UAAAA,KAAK,EAAEF,KAAK,CAACE,KAHf;EAIErC,UAAAA,EAAE,EAAEnC,CAAC,CAAC,IAAD,CAAD,CAAQ2D,IAAR,CAAa,IAAb;EAJN,SADJ,EAOI,UAASA,IAAT,EAAe;EACbxD,UAAAA,uBAAuB,CAACO,KAAxB,CAA8BE,GAA9B,CAAkC,+BAAlC,EAAmE0I,IAAnE,CAAwE3F,IAAxE;EACD,SATL;EAWD,OAhBL,EAiBKvC,GAjBL,CAiBS,OAjBT,EAiBkB,iCAjBlB,EAkBKC,EAlBL,CAkBQ,OAlBR,EAkBiB,iCAlBjB,EAkBoD,UAASyB,CAAT,EAAY;EAC1D3C,QAAAA,uBAAuB,CAAC0F,WAAxB;EACA/C,QAAAA,CAAC,CAACC,cAAF,GAF0D;;EAI1D5C,QAAAA,uBAAuB,CAACa,YAAxB;EACD,OAvBL,EAwBKI,GAxBL,CAwBS,OAxBT,EAwBkB,kCAxBlB,EAyBKC,EAzBL,CAyBQ,OAzBR,EAyBiB,kCAzBjB,EAyBqD,UAASyB,CAAT,EAAY;EAC3DA,QAAAA,CAAC,CAACC,cAAF;EACA5C,QAAAA,uBAAuB,CAAC0F,WAAxB;EACA,YAAM1D,EAAE,GAAG,KAAKN,YAAL,CAAkB,SAAlB,CAAX;EACA1B,QAAAA,uBAAuB,CAACsK,OAAxB,CAAgC;EAC9BC,UAAAA,OAAO,EAAE,mBAAM;EACbvK,YAAAA,uBAAuB,CAACiI,QAAxB,CAAiCtC,KAAjC;EACAgK,YAAAA,aAAa,CAAC3N,EAAD,EAAK,IAAL,CAAb;EACD,WAJ6B;EAK9BkO,UAAAA,kBAAkB,EAAE;EALU,SAAhC;EAOD,OApCL;EAsCD,KAv/B6B;EAw/B9B;EACAlP,IAAAA,IAz/B8B,kBAy/BvB;EACLnB,MAAAA,CAAC,CAAC,+BAAD,CAAD,CACKoB,GADL,CACS,OADT,EACkB,+BADlB,EAEKC,EAFL,CAEQ,OAFR,EAEiB,+BAFjB;EAAA,4EAEkD,kBAAeyB,CAAf;EAAA;;EAAA;EAAA;EAAA;EAAA;EAC5CA,kBAAAA,CAAC,CAACC,cAAF;EAEMoC,kBAAAA,IAHsC,GAG/BnF,CAAC,CAAC,IAAD,CAAD,CAAQ2D,IAAR,CAAa,MAAb,CAH+B;EAItCuG,kBAAAA,KAJsC,GAI9BlK,CAAC,CAAC,IAAD,CAAD,CAAQ2D,IAAR,CAAa,OAAb,CAJ8B;EAAA;EAAA,yBAMVV,IAAI,CAAC0G,IAAL,CAAU;EAC1CnJ,oBAAAA,KAAK,EAAE,EADmC;EAE1C8I,oBAAAA,IAAI,oLAEwEnE,IAFxE,iKAI2E+E,KAJ3E,oCAFsC;EAQ1CN,oBAAAA,YAAY,EAAE,KAR4B;EAS1CC,oBAAAA,iBAAiB,EAAE,eATuB;EAU1CC,oBAAAA,gBAAgB,EAAE,IAVwB;EAW1CC,oBAAAA,UAAU,EAAE;EAAA,6BAAO;EACjB5E,wBAAAA,IAAI,EAAEmL,QAAQ,CAACC,cAAT,CAAwB,8BAAxB,EAAwD/O,KAAxD,IAAiE,IADtD;EAEjB0I,wBAAAA,KAAK,EAAEoG,QAAQ,CAACC,cAAT,CAAwB,kCAAxB,EAA4D/O,KAA5D,IAAqE;EAF3D,uBAAP;EAAA;EAX8B,mBAAV,CANU;;EAAA;EAAA;EAM9BgJ,kBAAAA,UAN8B,qBAMrChJ,KANqC;;EAAA,sBAuBvCgJ,UAvBuC;EAAA;EAAA;EAAA;;EAAA;;EAAA;EA2B5CrK,kBAAAA,uBAAuB,CAAC2H,IAAxB,CACI;EACEC,oBAAAA,MAAM,EAAE,sCADV;EAEExD,oBAAAA,WAAW,EAAED,KAAK,CAACC,WAFrB;EAGEC,oBAAAA,KAAK,EAAEF,KAAK,CAACE,KAHf;EAIErC,oBAAAA,EAAE,EAAEnC,CAAC,CAAC,IAAD,CAAD,CAAQ2D,IAAR,CAAa,IAAb,CAJN;EAKEwB,oBAAAA,IAAI,EAAEqF,UAAU,CAACrF,IALnB;EAME+E,oBAAAA,KAAK,EAAEM,UAAU,CAACN;EANpB,mBADJ,EASI,UAASlC,QAAT,EAAmB;EACjB7H,oBAAAA,uBAAuB,CAACkF,kBAAxB,CAA2C2C,QAA3C,EAAqD,EAArD,EAAyD,yBAAzD,EADiB;;EAGjB7H,oBAAAA,uBAAuB,CAACa,YAAxB;EACD,mBAbL;;EA3B4C;EAAA;EAAA;EAAA;EAAA;EAAA;EAAA,SAFlD;;EAAA;EAAA;EAAA;EAAA;EA8CD,KAxiC6B;EAyiC9BwP,IAAAA,MAziC8B,oBAyiCrB;EACPrQ,MAAAA,uBAAuB,CAACgH,KAAxB,CAA8B8G,IAA9B;EACA9N,MAAAA,uBAAuB,CAACG,WAAxB,GAAsC,IAAtC;EACA2C,MAAAA,IAAI,CAACgE,KAAL;EACAgB,MAAAA,UAAU,CAAC;EAAA,eAAM9H,uBAAuB,CAAC2H,IAAxB,CACb;EACEC,UAAAA,MAAM,EAAE,wBADV;EAEExD,UAAAA,WAAW,EAAED,KAAK,CAACC,WAFrB;EAGEC,UAAAA,KAAK,EAAEF,KAAK,CAACE,KAHf;EAIEnE,UAAAA,IAAI,EAAEF,uBAAuB,CAACE;EAJhC,SADa,EAOb,UAAS2H,QAAT,EAAmB;EACjB7H,UAAAA,uBAAuB,CAACkF,kBAAxB,CAA2C2C,QAA3C,EAAqD,EAArD,EAAyD,yBAAzD;EACD,SATY,CAAN;EAAA,OAAD,EAUP,GAVO,CAAV;EAWD,KAxjC6B;;EAyjC9B;EACJ;EACA;EACA;EACA;EACIyC,IAAAA,OA9jC8B,mBA8jCtBA,QA9jCsB,EA8jCb;EACf,UAAI,OAAOA,QAAO,CAACC,OAAf,KAA2B,UAA3B,KAA0C,CAACD,QAAO,CAAC9G,IAAT,IAAiB,CAAC8G,QAAO,CAACgG,UAApE,CAAJ,EAAqF;EACnFxN,QAAAA,IAAI,CAACgE,KAAL;EACA9G,QAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,qDAAlC;EACA;EACD,OALc;;;EAQf,UAAI,CAAC/G,uBAAuB,CAACkD,KAAxB,CAA8BoH,OAA9B,CAAsCnB,IAAvC,IAA+C,CAACnJ,uBAAuB,CAACkD,KAAxB,CAA8BoH,OAA9B,CAAsC4B,YAA1F,EAAwG;EACtG,YAAMqE,MAAM,GAAG1Q,CAAC,CAAC,gCAAD,CAAhB;EACA,YAAMsJ,IAAI,GAAGoH,MAAM,CAACpH,IAAP,EAAb;EACA,YAAMG,MAAM,GAAGiH,MAAM,CAAC9N,IAAP,CAAY,uBAAZ,CAAf;EACAzC,QAAAA,uBAAuB,CAACkD,KAAxB,CAA8BoH,OAA9B,CAAsCnB,IAAtC,GAA6CA,IAAI,IAAI,IAArD;EACAnJ,QAAAA,uBAAuB,CAACkD,KAAxB,CAA8BoH,OAA9B,CAAsC4B,YAAtC,GAAqD5C,MAAM,IAAI,IAA/D;EACAiH,QAAAA,MAAM,CAAChH,MAAP;EACD;;EAED1J,MAAAA,CAAC,CAAC,MAAD,CAAD,CACKoB,GADL,CACS,OADT,EACkB,oCADlB,EAEKC,EAFL,CAEQ,OAFR,EAEiB,oCAFjB,EAEuD,UAASyB,CAAT,EAAY;EAC7DA,QAAAA,CAAC,CAACC,cAAF;EACA,YAAMiH,SAAS,GAAG/G,IAAI,CAACC,YAAL,EAAlB;EACA,YAAMyN,KAAK,GAAG3Q,CAAC,CAACgK,SAAD,CAAD,CAAazI,IAAb,CAAkB,8BAAlB,CAAd;EACAoP,QAAAA,KAAK,CAACzH,MAAN;;EACA,YAAIyH,KAAK,CAACxH,EAAN,CAAS,UAAT,CAAJ,EAA0B;EACxBa,UAAAA,SAAS,CAAC4G,UAAV,CAAqB,CAArB,EAAwBC,KAAxB,CAA8BC,KAA9B,GAAsC,MAAtC;EACA9G,UAAAA,SAAS,CAAC6G,KAAV,CAAgB,SAAhB,IAA6B,IAA7B;EACD,SAHD,MAGO;EACL7G,UAAAA,SAAS,CAAC4G,UAAV,CAAqB,CAArB,EAAwBC,KAAxB,CAA8BC,KAA9B,GAAsC,OAAtC;EACD;EACF,OAbL;EAgBArG,MAAAA,QAAO,CAAC4F,kBAAR,GAA6B,UAAU5F,QAAO,CAAC4F,kBAA/C;EAEAlQ,MAAAA,uBAAuB,CAACkD,KAAxB,CAA8BoH,OAA9B,CAAsCpH,KAAtC,GAA8CJ,IAAI,CAAC8N,KAAL,CAAW;EACvDC,QAAAA,WAAW,EAAE;EACXC,UAAAA,YAAY,EAAE,sDADH;EAEXC,UAAAA,OAAO,EAAE;EAFE,SAD0C;EAKvDC,QAAAA,cAAc,EAAE;EALuC,OAAX,EAM3CxH,IAN2C,CAMtC;EACNL,QAAAA,IAAI,EAAEnJ,uBAAuB,CAACkD,KAAxB,CAA8BoH,OAA9B,CAAsCnB,IADtC;EAEN8H,QAAAA,gBAAgB,EAAEjR,uBAAuB,CAACkD,KAAxB,CAA8BoH,OAA9B,CAAsC4B,YAFlD;EAGNvC,QAAAA,gBAAgB,EAAEW,QAAO,CAAC4F,kBAHpB;EAINgB,QAAAA,iBAAiB,EAAE,KAJb;EAKNC,QAAAA,iBAAiB,EAAE,KALb;EAMNC,QAAAA,cAAc,EAAE,KANV;EAONT,QAAAA,KAAK,EAAE,GAPD;EAQNU,QAAAA,QAAQ,EAAE,oBAAM;EACd,cAAMC,UAAU,GAAGxO,IAAI,CAACC,YAAL,GAAoBwO,sBAApB,CAA2C,iCAA3C,EAA8E,CAA9E,CAAnB;;EACA,cAAMC,SAAS,GAAGF,UAAU,CAACG,SAAX,CAAqB,IAArB,CAAlB;;EACAH,UAAAA,UAAU,CAACI,UAAX,CAAsBC,YAAtB,CAAmCH,SAAnC,EAA8CF,UAA9C;;EAEAE,UAAAA,SAAS,CAACzR,gBAAV,CAA2B,OAA3B,EAAoC,UAAS4C,CAAT,EAAY;EAC9C,gBAAI+M,OAAO,CAAC,6CAAD,CAAX,EAA4D;EAC1D5M,cAAAA,IAAI,CAACgE,KAAL;EACD;EACF,WAJD;;EAMA,cAAI,OAAOwD,QAAO,CAACC,OAAf,KAA2B,UAA/B,EAA2C;EACzCD,YAAAA,QAAO,CAACC,OAAR;;EACA;EACD;;EAED,cAAI,CAACD,QAAO,CAAC9G,IAAT,IAAiB,CAAC8G,QAAO,CAACgG,UAA9B,EAA0C;EACxCxN,YAAAA,IAAI,CAACgE,KAAL;EACA9G,YAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,qDAAlC;EACA;EACD;;EAED/G,UAAAA,uBAAuB,CAAC2H,IAAxB,CAA6B2C,QAAO,CAAC9G,IAArC,EAA2C8G,QAAO,CAACgG,UAAnD;EACD,SA/BK;EAgCNsB,QAAAA,YAAY,EAAE;EAAA,iBAAM,OAAOtH,QAAO,CAACsH,YAAf,KAAgC,UAAhC,IAA8CtH,QAAO,CAACsH,YAAR,EAApD;EAAA,SAhCR;EAiCNC,QAAAA,OAAO,EAAE,mBAAM;EACb1K,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;EACApH,UAAAA,uBAAuB,CAACqQ,MAAxB;EACD;EApCK,OANsC,CAA9C;EA4CD,KA7oC6B;EA8oC9BrI,IAAAA,eA9oC8B,2BA8oCdH,QA9oCc,EA8oCJiK,QA9oCI,EA8oCM;EAClC,UAAIjK,QAAQ,KAAK,IAAjB,EAAuB;EACrB/E,QAAAA,IAAI,CAACgE,KAAL;EACA9G,QAAAA,uBAAuB,CAAC+G,SAAxB,CAAkC,wBAAlC;EACA,cAAM,IAAIgL,KAAJ,wBAA+BlK,QAA/B,CAAN;EACD;;EAED,UAAMhF,UAAU,GAAGhD,CAAC,CAACiD,IAAI,CAACC,YAAL,EAAD,CAApB;;EACA,UAAM1C,KAAK,GAAG,SAARA,KAAQ,GAAM;EAClB,YAAI,CAACwH,QAAQ,CAACxH,KAAT,IAAkBwH,QAAQ,CAACmK,WAA5B,KAA4CF,QAAQ,KAAK,IAA7D,EAAmE;EACjEjP,UAAAA,UAAU,CAACzB,IAAX,CAAgB,+BAAhB,EAAiDoB,IAAjD,CAAsDqF,QAAQ,CAACxH,KAAT,IAAkBwH,QAAQ,CAACmK,WAAjF;EACD;EACF,OAJD;;EAKA,UAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;EACvB,YAAIpK,QAAQ,CAACoK,UAAb,EAAyB;EACvBpP,UAAAA,UAAU,CAACzB,IAAX,CAAgB,iCAAhB,EAAmDoB,IAAnD,CAAwDqF,QAAQ,CAACoK,UAAjE;EACD;EACF,OAJD;;EAKA,UAAMC,IAAI,GAAG,SAAPA,IAAO,GAAM;EACjB,YAAI,CAACrK,QAAQ,CAACI,QAAd,EAAwB;EACtB;EACD;;EACD,YAAMK,cAAc,GAAGzF,UAAU,CAACzB,IAAX,CAAgB,8BAAhB,CAAvB;EACA,YAAM+Q,aAAa,GAAG,CACpBnS,uBAAuB,CAACiI,QAAxB,CAAiC4E,KADb,EAEpB7M,uBAAuB,CAACiI,QAAxB,CAAiC+E,QAFb,CAAtB;;EAIA,YAAMpC,aAAa,GAAG,SAAhBA,aAAgB,CAACpC,OAAD,EAAa;EACjC,cAAIwB,KAAK,CAACuD,OAAN,CAAc/E,OAAd,CAAJ,EAA4B;EAC1B,iEAAmBA,OAAnB,wCAA4B;EAAA,kBAAjBhC,IAAiB;EAC1BoE,cAAAA,aAAa,CAACpE,IAAD,CAAb;EACD;;EACD;EACD;;EACD,cAAMiC,QAAQ,oCAAkCD,OAAO,CAACtI,IAAR,CAAawI,WAAb,EAAhD;EACAJ,UAAAA,cAAc,CAACrF,MAAf,iBAAmCwF,QAAnC,YAAiDD,OAAO,CAACtI,IAAzD,aAAqEsI,OAAO,CAACG,IAA7E,YAAwFH,OAAO,CAACA,OAAhG;;EAEA,cAAI2J,aAAa,CAACzL,QAAd,CAAuB8B,OAAO,CAACtI,IAAR,CAAawI,WAAb,EAAvB,CAAJ,EAAwD;EACtD1I,YAAAA,uBAAuB,CAACqQ,MAAxB;EACAvI,YAAAA,UAAU,CAAC9H,uBAAuB,CAACmI,SAAzB,EAAoC,GAApC,CAAV;EACD;EACF,SAdD;;EAeA,8DAAsBN,QAAQ,CAACI,QAA/B,2CAAyC;EAAA,cAA9BO,OAA8B;;EACvC,cAAI,CAACA,OAAL,EAAc;EACZ;EACD;;EACDxI,UAAAA,uBAAuB,CAACiI,QAAxB,CAAiCqF,UAAjC,CAA4C9E,OAA5C;EACAoC,UAAAA,aAAa,CAACpC,OAAD,CAAb;EACD;;EAED,YAAIF,cAAc,CAACU,EAAf,CAAkB,UAAlB,CAAJ,EAAmC;EACjCV,UAAAA,cAAc,CAAC8J,SAAf,CAAyB9J,cAAc,CAAC,CAAD,CAAd,CAAkB+J,YAA3C;EACD;;EAED,YAAI,CAACrS,uBAAuB,CAACiI,QAAxB,CAAiCC,UAAjC,EAAL,EAAoD;EAClD;EACD;;EAED,YAAMoK,YAAY,GAAGzP,UAAU,CAACzB,IAAX,CAAgB,oCAAhB,CAArB;EACAkR,QAAAA,YAAY,CAACnJ,IAAb,CAAkBmJ,YAAY,CAAC7P,IAAb,CAAkB,cAAlB,CAAlB;EAEA6P,QAAAA,YAAY,CACPlR,IADL,CACU,qCADV,EAEKoB,IAFL,CAEUxC,uBAAuB,CAACiI,QAAxB,CAAiCoF,WAAjC,CAA6CrN,uBAAuB,CAACiI,QAAxB,CAAiC+E,QAA9E,CAFV;EAKAsF,QAAAA,YAAY,CACPlR,IADL,CACU,kCADV,EAEKoB,IAFL,CAEUxC,uBAAuB,CAACiI,QAAxB,CAAiCoF,WAAjC,CAA6CrN,uBAAuB,CAACiI,QAAxB,CAAiC4E,KAA9E,CAFV;EAKAyF,QAAAA,YAAY,CACPlR,IADL,CACU,oCADV,EAEKoB,IAFL,CAEUxC,uBAAuB,CAACiI,QAAxB,CAAiCoF,WAAjC,CAA6CrN,uBAAuB,CAACiI,QAAxB,CAAiC2E,OAA9E,CAFV;EAID,OAzDD;;EA2DAvM,MAAAA,KAAK;EACL4R,MAAAA,UAAU;EACVC,MAAAA,IAAI;;EAEJ,UAAIrK,QAAQ,CAACP,MAAT,KAAoB,IAApB,IAA4BO,QAAQ,CAACmI,QAAT,KAAsB,IAAtD,EAA4D;EAC1DhQ,QAAAA,uBAAuB,CAACgH,KAAxB,CAA8B8G,IAA9B;EACA9N,QAAAA,uBAAuB,CAACG,WAAxB,GAAsC,IAAtC;EACD;EACF,KAnuC6B;EAouC9ByF,IAAAA,WApuC8B,uBAouClB2M,QApuCkB,EAouCR/O,IApuCQ,EAouCF;EAC1B,UAAMgH,GAAG,GAAG,EAAZ;EACA,UAAMgI,IAAI,GAAGD,QAAQ,CAAChM,KAAT,CAAe,GAAf,CAAb;EACA,UAAMkM,SAAS,GAAGD,IAAI,CAAC7Q,MAAL,GAAc,CAAhC;EACA6Q,MAAAA,IAAI,CAACE,MAAL,CAAY,UAACC,WAAD,EAAcC,OAAd,EAAuBvP,KAAvB,EAAiC;EAC3C,eAAOsP,WAAW,CAACC,OAAD,CAAX,GAAuBvP,KAAK,IAAIoP,SAAT,GAAqBjP,IAArB,GAA4B,EAA1D;EACD,OAFD,EAEGgH,GAFH;EAGA,aAAOA,GAAP;EACD,KA5uC6B;EA6uC9BrC,IAAAA,SA7uC8B,uBA6uClB;EACVrF,MAAAA,IAAI,CAAC0G,IAAL,CAAU;EACRL,QAAAA,IAAI,oJADI;EAERwH,QAAAA,KAAK,EAAE,KAFC;EAGRU,QAAAA,QAAQ,EAAE,oBAAM;EACd,cAAMxO,UAAU,GAAGhD,CAAC,CAACiD,IAAI,CAACC,YAAL,EAAD,CAApB;EACAF,UAAAA,UAAU,CAAC,CAAD,CAAV,CAAc6N,KAAd,CAAoB,SAApB,IAAiC,IAAjC;EAEA,cAAMpI,cAAc,GAAGzF,UAAU,CAACzB,IAAX,CAAgB,8BAAhB,CAAvB;EACA,cAAMyR,eAAe,GAAGhQ,UAAU,CAACzB,IAAX,CAAgB,4BAAhB,CAAxB;EACA,cAAM0R,aAAa,GAAGjT,CAAC,CAAC,0BAAD,CAAvB;EACA,cAAMoI,QAAQ,GAAGjI,uBAAuB,CAACiI,QAAzC;EACA,cAAM5H,KAAK,GAAGyS,aAAa,CAACrQ,IAAd,CAAmB,uBAAnB,EACTW,OADS,CACD,YADC,EACa6E,QAAQ,CAACoF,WAAT,CAAqBpF,QAAQ,CAAC+E,QAA9B,CADb,EAET5J,OAFS,CAED,UAFC,EAEW6E,QAAQ,CAACoF,WAAT,CAAqBpF,QAAQ,CAAC4E,KAA9B,CAFX,EAGTzJ,OAHS,CAGD,YAHC,EAGa6E,QAAQ,CAACoF,WAAT,CAAqBpF,QAAQ,CAAC2E,OAA9B,CAHb,CAAd;EAMAiG,UAAAA,eAAe,CAACE,MAAhB,UAA8B1S,KAA9B;EACA,cAAM2S,QAAQ,GAAG,CACfhT,uBAAuB,CAACiI,QAAxB,CAAiC+E,QADlB,EAEfhN,uBAAuB,CAACiI,QAAxB,CAAiC4E,KAFlB,EAGf7M,uBAAuB,CAACiI,QAAxB,CAAiC2E,OAHlB,CAAjB;;EAMA,cAAI,CAAC5M,uBAAuB,CAACiI,QAAxB,CAAiCC,UAAjC,EAAL,EAAoD;EAClD2K,YAAAA,eAAe,CAACrR,IAAhB;EACD;;EAED,gEAAsByG,QAAQ,CAACzE,IAAT,CAAc+E,GAApC,2CAAyC;EAAA,gBAA9BC,OAA8B;EACvC,gBAAMC,QAAQ,oCAAkCD,OAAO,CAACtI,IAAR,CAAawI,WAAb,EAAhD,CADuC;;EAGvC,gBAAIsK,QAAQ,CAACtM,QAAT,CAAkB8B,OAAO,CAACtI,IAA1B,CAAJ,EAAqC;EACnC2S,cAAAA,eAAe,CAAC5P,MAAhB,iBACiBwF,QADjB,YAC+BD,OAAO,CAACtI,IADvC,aACmDsI,OAAO,CAACG,IAD3D,YACsEH,OAAO,CAACA,OAD9E;EAGD;;EACDF,YAAAA,cAAc,CAACrF,MAAf,iBACiBwF,QADjB,YAC+BD,OAAO,CAACtI,IADvC,aACmDsI,OAAO,CAACG,IAD3D,YACsEH,OAAO,CAACA,OAD9E;EAGD;EACF,SAxCO;EAyCRyK,QAAAA,MAAM,EAAE,gBAACpJ,SAAD,EAAe;EACrB,cAAMvB,cAAc,GAAGzI,CAAC,CAACgK,SAAD,CAAD,CAAazI,IAAb,CAAkB,8BAAlB,CAAvB;EACAkH,UAAAA,cAAc,CAAC8J,SAAf,CAAyB9J,cAAc,CAAC,CAAD,CAAd,CAAkB+J,YAA3C;EACD;EA5CO,OAAV;EA8CD,KA5xC6B;EA6xC9BvQ,IAAAA,aA7xC8B,gCA6xCgG;EAAA,8BAA/GzB,KAA+G;EAAA,UAA/GA,KAA+G,4BAAvG,IAAuG;EAAA,oCAAjG0B,WAAiG;EAAA,UAAjGA,WAAiG,kCAAnF,IAAmF;EAAA,2BAA7EC,EAA6E;EAAA,UAA7EA,EAA6E,yBAAxE,IAAwE;EAAA,4BAAlEP,GAAkE;EAAA,UAAlEA,GAAkE,0BAA5D,IAA4D;EAAA,qCAAtDQ,YAAsD;EAAA,UAAtDA,YAAsD,mCAAvC,QAAuC;EAAA,sCAA7BC,aAA6B;EAAA,UAA7BA,aAA6B,oCAAb,UAAa;;EAC5H,UAAI,SAASlC,uBAAuB,CAACkD,KAAxB,CAA8BiJ,QAA9B,CAAuChD,IAApD,EAA0D;EACxD,YAAMd,GAAG,GAAGxI,CAAC,CAAC,iCAAD,CAAb;EACAG,QAAAA,uBAAuB,CAACkD,KAAxB,CAA8BiJ,QAA9B,CAAuChD,IAAvC,GAA8Cd,GAAG,CAACc,IAAJ,EAA9C;EACAd,QAAAA,GAAG,CAACkB,MAAJ;EACD;;EAED,UAAM2J,WAAW,GAAG,SAAdA,WAAc;EAAA,eAAMpQ,IAAI,CAAC0G,IAAL,CAAU;EAClCL,UAAAA,IAAI,WAASpH,WAAT,8CAD8B;EAElC4H,UAAAA,gBAAgB,EAAE,KAFgB;EAGlCuH,UAAAA,iBAAiB,EAAE,KAHe;EAIlCG,UAAAA,QAAQ,EAAE,oBAAM;EACdrR,YAAAA,uBAAuB,CAAC2H,IAAxB,CACI;EACEC,cAAAA,MAAM,EAAE,wCADV;EAEExD,cAAAA,WAAW,EAAED,KAAK,CAACC,WAFrB;EAGEC,cAAAA,KAAK,EAAEF,KAAK,CAACE,KAHf;EAIErC,cAAAA,EAAE,EAAFA;EAJF,aADJ,EAOI,UAAS6F,QAAT,EAAmB;EACjBV,cAAAA,OAAO,CAACC,GAAR,CAAYS,QAAZ;;EACA,kBAAI,CAACA,QAAD,IAAa,CAACA,QAAQ,CAACmE,OAAvB,IAAkC,CAACnE,QAAQ,CAACrE,IAA5C,IAAoDqE,QAAQ,CAACrE,IAAT,CAAc7B,MAAd,GAAuB,CAA/E,EAAkF;EAChF;EACD;;EAED,kBAAMwR,CAAC,GAAGhD,QAAQ,CAACiD,aAAT,CAAuB,GAAvB,CAAV;EACAD,cAAAA,CAAC,CAACzC,KAAF,CAAQ2C,OAAR,GAAkB,MAAlB;EACAF,cAAAA,CAAC,CAACtR,IAAF,GAASgG,QAAQ,CAACrE,IAAlB;EACA2M,cAAAA,QAAQ,CAAClB,IAAT,CAAcqE,WAAd,CAA0BH,CAA1B;EACAA,cAAAA,CAAC,CAACxP,KAAF;EACAwM,cAAAA,QAAQ,CAAClB,IAAT,CAAcsE,WAAd,CAA0BJ,CAA1B;EAEArQ,cAAAA,IAAI,CAACgE,KAAL;EACD,aArBL;EAuBD;EA5BiC,SAAV,CAAN;EAAA,OAApB;;EA+BAhE,MAAAA,IAAI,CAAC8N,KAAL,CAAW;EACTC,QAAAA,WAAW,EAAE;EACXC,UAAAA,YAAY,EAAE,sDADH;EAEX0C,UAAAA,aAAa,EAAE,oEAFJ;EAGXC,UAAAA,OAAO,EAAE;EAHE,SADJ;EAMTzC,QAAAA,cAAc,EAAE;EANP,OAAX,EAQKxH,IARL,CAQU;EACJkK,QAAAA,IAAI,EAAE,SADF;EAEJvK,QAAAA,IAAI,EAAEnJ,uBAAuB,CAACkD,KAAxB,CAA8BiJ,QAA9B,CAAuChD,IAAvC,CAA4C/F,OAA5C,CAAoD,SAApD,EAA+D/C,KAA/D,EAAsE+C,OAAtE,CAA8E,aAA9E,EAA6F,WAA7F,CAFF;EAGJ6N,QAAAA,gBAAgB,EAAEhP,YAHd;EAIJyH,QAAAA,iBAAiB,EAAExH,aAJf;EAKJyH,QAAAA,gBAAgB,EAAE,IALd;EAMJuH,QAAAA,iBAAiB,EAAE;EANf,OARV,EAgBK5M,IAhBL,CAgBU,UAACqP,SAAD,EAAe;EACnB,YAAI,CAACA,SAAD,IAAc,CAACA,SAAS,CAACtS,KAA7B,EAAoC;EAClC;EACD;;EAED,YAAII,GAAG,IAAIA,GAAG,CAACE,MAAJ,GAAa,CAAxB,EAA2B;EACzB7B,UAAAA,MAAM,CAAC8B,QAAP,CAAgBC,IAAhB,GAAuBJ,GAAvB;EACA;EACD;;EAEDyR,QAAAA,WAAW;EACZ,OA3BL;EA6BD,KAh2C6B;EAi2C9B/Q,IAAAA,WAj2C8B,yBAi2ChB;EACZ,UAAMyR,iBAAiB,GAAG,SAApBA,iBAAoB,CAACpQ,IAAD,EAAU;EAClCxD,QAAAA,uBAAuB,CAAC0F,WAAxB;;EAEA,YAAI1F,uBAAuB,CAACG,WAA5B,EAAyC;EACvCgH,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EADuC;;EAGvC;EACD;;EAED,YAAMzB,KAAK,GAAGnC,IAAI,CAAC,OAAD,CAAlB;EACA,eAAOA,IAAI,CAAC,OAAD,CAAX;EACAA,QAAAA,IAAI,CAAC,iBAAD,CAAJ,GAA0B,CAA1B,CAXkC;;EAYlC,YAAIoC,WAAW,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBtC,IAAlB,CAAlB;EAEAoC,QAAAA,WAAW,GAAG5F,uBAAuB,CAAC4F,WAAxB,CACV,0BADU,eAEN5F,uBAAuB,CAACkD,KAAxB,WAAqCM,IAF/B,EAAd;EAKAxD,QAAAA,uBAAuB,CAACgH,KAAxB,CAA8BC,KAA9B;;EAEA,YAAMC,UAAU,GAAG,SAAbA,UAAa,GAAM;EACvBC,UAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;EACAC,UAAAA,aAAa,CAACrH,uBAAuB,CAACI,WAAxB,CAAoCE,QAArC,CAAb;EACAN,UAAAA,uBAAuB,CAACI,WAAxB,CAAoCE,QAApC,GAA+C,IAA/C;EACD,SAJD;;EAKA,YAAMgH,MAAM,GAAG,SAATA,MAAS,GAAM;EACnB,cAAItH,uBAAuB,CAACI,WAAxB,CAAoCE,QAApC,KAAiD,IAArD,EAA2D;EACzD;EACD;;EACD6G,UAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ;EACApH,UAAAA,uBAAuB,CAACI,WAAxB,CAAoCE,QAApC,GAA+CiH,WAAW,CAAC,YAAM;EAC/D,gBAAI,SAASvH,uBAAuB,CAACG,WAArC,EAAkD;EAChD+G,cAAAA,UAAU;EACV;EACD;;EAED,gBAAIlH,uBAAuB,CAACsH,MAAxB,CAA+BE,WAA/B,KAA+C,KAAnD,EAA0D;EACxD;EACD;;EAEDxH,YAAAA,uBAAuB,CAACsH,MAAxB,CAA+BE,WAA/B,GAA6C,KAA7C;EACAzD,YAAAA,KAAK,CAAIC,OAAJ,mEAAyEG,KAAK,CAACC,WAA/E,eAAoGD,KAAK,CAACE,KAA1G,CAAL,CACKC,IADL,CACU,UAACE,GAAD;EAAA,qBAASA,GAAG,CAACC,IAAJ,EAAT;EAAA,aADV,EAEKH,IAFL,CAEU,UAACE,GAAD,EAAS;EACbxE,cAAAA,uBAAuB,CAACsH,MAAxB,CAA+BE,WAA/B,GAA6C,IAA7C;;EACA,kBAAI,OAAOhD,GAAP,KAAe,WAAnB,EAAgC;EAC9B0C,gBAAAA,UAAU;EACX;;EAED,kBAAIlH,uBAAuB,CAACI,WAAxB,CAAoCC,KAApC,KAA8CmE,GAAG,CAACiD,kBAAtD,EAA0E;EACxE;EACD;;EAEDzH,cAAAA,uBAAuB,CAACI,WAAxB,CAAoCC,KAApC,GAA4CmE,GAAG,CAACiD,kBAAhD;EACA,kBAAM5E,UAAU,GAAGhD,CAAC,CAACiD,IAAI,CAACC,YAAL,EAAD,CAApB;EACAF,cAAAA,UAAU,CAACzB,IAAX,CAAgB,+BAAhB,EAAiDoB,IAAjD,CAAsDgC,GAAG,CAACiD,kBAA1D;EACA5E,cAAAA,UAAU,CAACzB,IAAX,CAAgB,iCAAhB,EAAmDoB,IAAnD,CAAwD,GAAxD;EACD,aAhBL,WAiBW,UAACG,CAAD,EAAO;EACZ3C,cAAAA,uBAAuB,CAACsH,MAAxB,CAA+BE,WAA/B,GAA6C,IAA7C;EACAxH,cAAAA,uBAAuB,CAACkF,kBAAxB,CAA2CvC,CAA3C,EAA8C,EAA9C,EAAkD,yBAAlD;EACD,aApBL;EAsBD,WAjCyD,EAiCvD,IAjCuD,CAA1D;EAkCD,SAvCD;;EAyCA+E,QAAAA,SAAS,CAACC,IAAV,CACI;EACEC,UAAAA,MAAM,EAAE,yCADV;EAEExD,UAAAA,WAAW,EAAED,KAAK,CAACC,WAFrB;EAGEC,UAAAA,KAAK,EAAEF,KAAK,CAACE,KAHf;EAIEsB,UAAAA,KAAK,EAALA,KAJF;EAKExB,UAAAA,KAAK,EAAEyB;EALT,SADJ,EAQI,UAASiC,QAAT,EAAmB;EACjB,cAAI,OAAOA,QAAP,KAAoB,WAAxB,EAAqC;EACnCC,YAAAA,UAAU,CAAC,YAAW;EACpB8L,cAAAA,iBAAiB,CAACpQ,IAAD,CAAjB;EACD,aAFS,EAEPW,KAAK,CAAC4D,QAFC,CAAV;EAGA;EACD;;EAED/H,UAAAA,uBAAuB,CAACgI,eAAxB,CAAwCH,QAAxC,EAAkD,IAAlD;;EACA,cAAI,CAAC7H,uBAAuB,CAACI,WAAxB,CAAoCE,QAAzC,EAAmD;EACjDgH,YAAAA,MAAM;EACP;;EAED,cAAIO,QAAQ,CAACP,MAAT,KAAoB,KAAxB,EAA+B;EAC7BsM,YAAAA,iBAAiB,CAACpQ,IAAD,CAAjB;EACD,WAFD,MAEO,IAAIqE,QAAQ,CAACP,MAAT,KAAoB,IAAxB,EAA8B;EACnCzH,YAAAA,CAAC,CAAC,0BAAD,CAAD,CAA8B2C,IAA9B,CAAmC,+BAAnC;EACAxC,YAAAA,uBAAuB,CAACE,IAAxB,GAA+B,IAA/B;;EACA,gBAAIF,uBAAuB,CAACiI,QAAxB,CAAiCC,UAAjC,EAAJ,EAAmD;EACjD;EACAlI,cAAAA,uBAAuB,CAACa,YAAxB;EACAb,cAAAA,uBAAuB,CAACmI,SAAxB;EACA;EACD;;EACDjB,YAAAA,UAAU;EACV,gBAAM2M,UAAU,GAAGhU,CAAC,CAAC,8BAAD,CAAD,CAAkCY,GAAlC,CAAsC,CAAtC,EAAyCqT,SAA5D;EACA,gBAAM3K,IAAI,GAAG,8CAA8C0K,UAA9C,GAA2D,QAAxE;EACA,gBAAME,UAAU,GAAG5K,IAAI,CAACzC,QAAL,CAAc,qCAAd,KAAwDyC,IAAI,CAACzC,QAAL,CAAc,mCAAd,CAAxD,GAA6G,mBAA7G,GAAmI,EAAtJ;EACAS,YAAAA,OAAO,CAACC,GAAR,CAAY,mBAAmB2M,UAA/B,EAbmC;EAenC;EAEA;;EACAjR,YAAAA,IAAI,CAAC0G,IAAL,CAAU;EACRkK,cAAAA,IAAI,EAAE,SADE;EAERrT,cAAAA,KAAK,EAAE,UAFC;EAGR8I,cAAAA,IAAI,EAAE,sFAAsF4K,UAAtF,GAAmG,kGAAnG,GAAwM5K;EAHtM,aAAV,EAlBmC;;EA0BnCnJ,YAAAA,uBAAuB,CAACa,YAAxB;EACD,WA3BM,MA2BA;EACLiH,YAAAA,UAAU,CAAC,YAAW;EACpB8L,cAAAA,iBAAiB,CAACpQ,IAAD,CAAjB;EACD,aAFS,EAEPW,KAAK,CAAC4D,QAFC,CAAV;EAGD;EACF,SAvDL,EAwDI,MAxDJ,EAyDI,KAzDJ,EA0DI,CA1DJ;EA2DI,YA3DJ;EA6DD,OAhID;;EAkIA,UAAI,CAAC/H,uBAAuB,CAACkD,KAAxB,WAAqCiG,IAA1C,EAAgD;EAC9C,YAAMoH,MAAM,GAAG1Q,CAAC,CAAC,+BAAD,CAAhB,CAD8C;;EAI9C,YAAMmU,KAAK,GAAGzD,MAAM,CAACnP,IAAP,CAAY,iEAAZ,CAAd;EACApB,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCC,iBAArC,GAAyD6Q,KAAK,CAAC7K,IAAN,EAAzD;EACA6K,QAAAA,KAAK,CAAC5S,IAAN,CAAW,4DAAX,EAAyEmI,MAAzE;EACAyK,QAAAA,KAAK,CAAC7K,IAAN,CAAWnJ,uBAAuB,CAACkD,KAAxB,WAAqCC,iBAArC,CAAuDC,OAAvD,CAA+D,MAA/D,EAAuE,CAAvE,CAAX;EAEApD,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCiG,IAArC,GAA4CoH,MAAM,CAACpH,IAAP,EAA5C;EACAnJ,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCyJ,aAArC,GAAqD4D,MAAM,CAAC9N,IAAP,CAAY,oBAAZ,CAArD;EACAzC,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCkJ,UAArC,GAAkDmE,MAAM,CAAC9N,IAAP,CAAY,qBAAZ,CAAlD;EACAzC,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqChB,aAArC,GAAqDqO,MAAM,CAAC9N,IAAP,CAAY,wBAAZ,CAArD;EACAzC,QAAAA,uBAAuB,CAACkD,KAAxB,WAAqCjB,YAArC,GAAoDsO,MAAM,CAAC9N,IAAP,CAAY,uBAAZ,CAApD;EACA8N,QAAAA,MAAM,CAAChH,MAAP;EACD;;EAEDvJ,MAAAA,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CC,MAA1C,GAAmD,EAAnD;EACAzD,MAAAA,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CJ,OAA1C,GAAoD,EAApD;EAEA,UAAI6Q,WAAW,GAAG,IAAlB;EACAnR,MAAAA,IAAI,CACC8N,KADL,CACW;EACLC,QAAAA,WAAW,EAAE;EACX2C,UAAAA,aAAa,EAAE,oEADJ;EAEX1C,UAAAA,YAAY,EAAE,sDAFH;EAGX2C,UAAAA,OAAO,EAAE;EAHE,SADR;EAMLzC,QAAAA,cAAc,EAAE,KANX;;EAAA,OADX,EAUKkD,KAVL,CAUW,CAAC;EACN/K,QAAAA,IAAI,EAAEnJ,uBAAuB,CAACkD,KAAxB,WAAqCiG,IADrC;EAENO,QAAAA,iBAAiB,EAAE1J,uBAAuB,CAACkD,KAAxB,WAAqCkJ,UAFlD;EAGNzC,QAAAA,gBAAgB,EAAE,KAHZ;EAINuH,QAAAA,iBAAiB,EAAE,IAJb;EAKNiD,QAAAA,mBAAmB,EAAE,IALf;EAMNxD,QAAAA,KAAK,EAAE,GAND;EAONU,QAAAA,QAPM,sBAOK;EACT4C,UAAAA,WAAW,GAAGpU,CAAC,CAAC,uCAAD,CAAf;EACAoU,UAAAA,WAAW,CAAC5O,IAAZ,CAAiB,UAAjB,EAA6B,IAA7B;EAEArF,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCW,eAArC,GAAuDhE,CAAC,CAAC,uCAAD,CAAxD;EACAG,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCU,mBAArC,GAA2D/D,CAAC,CAAC,2CAAD,CAA5D;EACD,SAbK;EAcN+J,QAAAA,UAdM,wBAcO;EACX,cAAMqF,IAAI,GAAG,IAAIC,QAAJ,EAAb;EACAD,UAAAA,IAAI,CAAChM,MAAL,CAAY,aAAZ,EAA2BkB,KAAK,CAACC,WAAjC;EACA6K,UAAAA,IAAI,CAAChM,MAAL,CAAY,OAAZ,EAAqBkB,KAAK,CAACE,KAA3B;EACA4K,UAAAA,IAAI,CAAChM,MAAL,CAAY,UAAZ,EAAwBjD,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CsB,IAAlE;EAEA9E,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CC,MAA1C,CAAiDoB,OAAjD,CAAyD,UAAC2B,IAAD,EAAOnD,KAAP,EAAiB;EACxE4L,YAAAA,IAAI,CAAChM,MAAL,aAAsBI,KAAtB,QAAgCmD,IAAhC;EACD,WAFD;EAGAxG,UAAAA,uBAAuB,CAACkD,KAAxB,WAAqCM,IAArC,CAA0CJ,OAA1C,CAAkDyB,OAAlD,CAA0D,UAAC2B,IAAD,EAAOnD,KAAP,EAAiB;EACzE4L,YAAAA,IAAI,CAAChM,MAAL,cAAuBI,KAAvB,QAAiCmD,IAAjC;EACD,WAFD;EAIA,iBAAOzC,KAAK,CAAIC,OAAJ,gDAAwD;EAClEoL,YAAAA,MAAM,EAAE,MAD0D;EAElEH,YAAAA,IAAI,EAAJA;EAFkE,WAAxD,CAAL,CAGJ3K,IAHI,CAGCtE,uBAAuB,CAACuE,iBAHzB,EAIFD,IAJE,CAIG,UAACE,GAAD;EAAA,mBAASA,GAAG,CAACC,IAAJ,EAAT;EAAA,WAJH,EAKFH,IALE,CAKG,UAAC6E,IAAD,EAAU;EACd,mBAAOrG,IAAI,CAACsR,eAAL,CAAqB;EAC1BjL,cAAAA,IAAI,EAAEA,IADoB;EAE1BO,cAAAA,iBAAiB,EAAE1J,uBAAuB,CAACkD,KAAxB,WAAqChB,aAF9B;EAG1B+O,cAAAA,gBAAgB,EAAEjR,uBAAuB,CAACkD,KAAxB,WAAqCjB,YAH7B;EAI1B0H,cAAAA,gBAAgB,EAAE;EAJQ,aAArB,CAAP;EAMD,WAZE,WAaI,UAAChH,CAAD;EAAA,mBAAO3C,uBAAuB,CAACkF,kBAAxB,CAA2CvC,CAA3C,EAA8C,EAA9C,EAAkD,yBAAlD,CAAP;EAAA,WAbJ,CAAP;EAeD;EA1CK,OAAD,CAVX,EAsDK2B,IAtDL,CAsDU,UAACE,GAAD,EAAS;EACb,YAAI,CAACA,GAAD,IAAQ,CAACA,GAAG,CAACnD,KAAb,IAAsB,CAACmD,GAAG,CAACnD,KAAJ,CAAU,CAAV,CAAvB,IAAuCmD,GAAG,CAACnD,KAAJ,CAAU,CAAV,MAAiB,IAA5D,EAAkE;EAChE;EACD;;EAEDrB,QAAAA,uBAAuB,CAACG,WAAxB,GAAsC,KAAtC;EACA,YAAMqD,IAAI,GAAGxD,uBAAuB,CAACkD,KAAxB,WAAqCM,IAAlD;EACAA,QAAAA,IAAI,CAAC,MAAD,CAAJ,GAAexD,uBAAuB,CAACkD,KAAxB,WAAqCyJ,aAArC,GAAqDnJ,IAAI,CAAC,MAAD,CAAxE;EACAA,QAAAA,IAAI,CAAC,OAAD,CAAJ,GAAgB,IAAhB;EAEAxD,QAAAA,uBAAuB,CAACsK,OAAxB,CAAgC;EAC9BC,UAAAA,OAAO,EAAE,mBAAM;EACbvK,YAAAA,uBAAuB,CAACiI,QAAxB,CAAiCtC,KAAjC;EACAiO,YAAAA,iBAAiB,CAACpQ,IAAD,CAAjB;EACD;EAJ6B,SAAhC;EAMD,OAtEL;EAwED;EAjkD6B,GAAhC;EAmkDD,CAxkDA,EAwkDC6Q,MAxkDD,CAAD;;;;;;"}